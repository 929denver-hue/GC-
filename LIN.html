<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¬å¹´å¥½é‹å•Ÿå‹•å°ï½œè¬é¦¬å¥”é¨°ç‰ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500&family=Noto+Serif+TC:wght@600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- è¦–è¦ºèˆ‡è‰²ç¥¨è¨­å®š (æ¥µç°¡éå¹´é¢¨) --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #7A1614 0%, #3B0A09 100%);
            --primary-red: #B22222; 
            --accent-gold: #D4AF37; 
            --text-light: #FDFBF7; 
            --bg-dark-panel: rgba(0, 0, 0, 0.4);
            --font-serif: 'Noto Serif TC', serif;
            --font-sans: 'Noto Sans TC', sans-serif;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: var(--bg-gradient); color: var(--text-light);
            font-family: var(--font-sans);
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
        }

        .container {
            width: 95%; max-width: 600px; height: 95vh;
            padding: 40px 20px; box-sizing: border-box;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center; position: relative;
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* --- è¦–è¦ºåŒ–çš„å¾Œå°è§¸ç™¼å°ç«  --- */
        .secret-seal {
            position: absolute; top: 15px; right: 15px;
            width: 36px; height: 36px;
            border: 1.5px solid var(--accent-gold); color: var(--accent-gold);
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-family: var(--font-serif); font-size: 1.1rem;
            opacity: 0.3; cursor: pointer; z-index: 999; transition: 0.3s;
        }
        .secret-seal:active { opacity: 1; transform: scale(0.9); }

        /* --- ç•«é¢åˆ‡æ›é‚è¼¯ --- */
        .screen { display: none; width: 100%; animation: fadeIn 0.8s ease; }
        .screen.active { display: flex; flex-direction: column; align-items: center; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- å­—é«”èˆ‡æ’ç‰ˆ --- */
        h1, h2, .serif-text { font-family: var(--font-serif); font-weight: 600; letter-spacing: 2px; margin: 0; }
        .title { font-size: 2.8rem; color: var(--accent-gold); margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .subtitle { font-size: 1.1rem; color: var(--text-light); opacity: 0.9; margin-bottom: 50px; font-weight: 400; }
        .divider { width: 50px; height: 2px; background-color: var(--accent-gold); margin: 30px auto; opacity: 0.5; }

        /* --- è¼¸å…¥å€è¨­è¨ˆ --- */
        .name-input {
            width: 80%; background: var(--bg-dark-panel); 
            border: 1px solid var(--accent-gold); border-radius: 8px;
            color: var(--text-light); font-size: 1.5rem; font-family: var(--font-serif);
            text-align: center; padding: 15px; box-sizing: border-box; outline: none; margin-bottom: 30px;
        }
        .name-input:focus { background: rgba(0,0,0,0.6); box-shadow: 0 0 10px rgba(212, 175, 55, 0.3); }
        .name-input::placeholder { color: rgba(253, 251, 247, 0.4); font-family: var(--font-sans); font-size: 1rem; }

        .btn-primary {
            background-color: transparent; color: var(--accent-gold);
            border: 2px solid var(--accent-gold); border-radius: 30px;
            padding: 15px 50px; font-size: 1.2rem;
            font-family: var(--font-serif); letter-spacing: 2px; cursor: pointer;
            transition: all 0.3s; background: rgba(212, 175, 55, 0.1);
        }
        .btn-primary:hover { background-color: var(--accent-gold); color: #3B0A09; font-weight: bold; }

        /* --- è¬é¦¬å¥”é¨°å‹•ç•«å€ --- */
        .spin-circle {
            width: 220px; height: 220px; border: 3px dashed var(--accent-gold);
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            margin: 40px auto; background: rgba(0,0,0,0.2); position: relative;
        }
        
        .main-horse { font-size: 5rem; color: var(--accent-gold); font-family: var(--font-serif); text-shadow: 0 0 15px rgba(212, 175, 55, 0.5); z-index: 10; }
        
        /* éš±è—çš„å¥”é¨°é¦¬ç¾¤ (åƒ…åœ¨å•Ÿå‹•æ™‚é¡¯ç¤º) */
        .galloping-horses { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; display: none; }
        .galloping-horses span {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-family: var(--font-serif); color: var(--accent-gold); opacity: 0;
        }

        /* æ—‹è½‰èˆ‡å¥”é¨°è§¸ç™¼ */
        .spinning .main-horse { animation: spinAnim 5s cubic-bezier(0.2, 0.8, 0.3, 1) forwards; }
        .spinning .spin-circle { border-style: solid; box-shadow: 0 0 30px rgba(212, 175, 55, 0.6); transition: 0.5s; }
        .spinning .galloping-horses { display: block; }

        /* æ¯åŒ¹é¦¬ä¸åŒçš„å‡ºç™¼é»èˆ‡å¥”é¨°å‹•ç•« */
        .spinning .galloping-horses span:nth-child(1) { animation: stampede 1.2s linear infinite 0.1s; font-size: 2rem; }
        .spinning .galloping-horses span:nth-child(2) { animation: stampede 1.5s linear infinite 0.4s; font-size: 3rem; color: #E8C373; }
        .spinning .galloping-horses span:nth-child(3) { animation: stampede 1.1s linear infinite 0.7s; font-size: 4rem; color: rgba(255,255,255,0.8); }
        .spinning .galloping-horses span:nth-child(4) { animation: stampede 1.4s linear infinite 1.0s; font-size: 2.5rem; }
        .spinning .galloping-horses span:nth-child(5) { animation: stampede 1.3s linear infinite 1.3s; font-size: 3.5rem; color: #E8C373; }
        .spinning .galloping-horses span:nth-child(6) { animation: stampede 1.6s linear infinite 1.6s; font-size: 1.5rem; color: rgba(255,255,255,0.6); }

        @keyframes spinAnim { 0% { transform: rotate(0deg); } 100% { transform: rotate(1440deg); } }
        
        /* å¥”é¨°æ ¸å¿ƒï¼šå¾ä¸­å¿ƒæ—‹è½‰ä¸¦æ”¾å¤§è¡å‡ºï¼Œæœ€å¾Œæ·¡å‡º */
        @keyframes stampede {
            0% { transform: translate(-50%, -50%) scale(0.1) rotate(0deg); opacity: 0; }
            30% { opacity: 0.8; }
            100% { transform: translate(-50%, -50%) scale(5) rotate(180deg); opacity: 0; }
        }

        .spin-text { font-size: 1.2rem; letter-spacing: 2px; color: var(--accent-gold); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }

        /* --- çµæœç•«é¢ --- */
        .result-name { font-size: 2.2rem; color: var(--accent-gold); margin-bottom: 10px; }
        .reward-box { background: var(--bg-dark-panel); border: 1px solid var(--accent-gold); border-radius: 8px; padding: 30px; width: 85%; margin: 20px 0; }
        .reward-title { font-size: 1rem; color: var(--text-light); opacity: 0.8; margin-bottom: 10px; }
        .reward-content { font-size: 1.8rem; color: var(--accent-gold); font-weight: bold; }
        .quote-text { font-size: 1.2rem; line-height: 1.8; padding: 0 20px; margin: 30px 0; opacity: 0.9; }

        /* --- å¾Œå°ç®¡ç†ä»‹é¢ --- */
        .admin-panel { text-align: left; width: 90%; max-width: 500px; }
        .admin-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--accent-gold); padding-bottom: 10px; margin-bottom: 20px; }
        .admin-stat-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .admin-stat { background: var(--bg-dark-panel); padding: 15px; border-radius: 5px; flex: 1; margin: 0 5px; text-align: center;}
        .admin-stat span { font-size: 1.5rem; color: var(--accent-gold); font-weight: bold; display: block; margin-top: 5px;}
        .setting-box { background: rgba(0,0,0,0.5); padding: 15px; border-radius: 5px; margin-top: 20px; border: 1px solid rgba(255,255,255,0.2); }
        .setting-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.9rem; }
        .qty-input { width: 60px; padding: 5px; text-align: center; background: transparent; border: 1px solid var(--accent-gold); color: white; border-radius: 4px; }
        .history-list { max-height: 200px; overflow-y: auto; background: rgba(0,0,0,0.6); padding: 10px; font-size: 0.9rem; margin-top: 20px; border-radius: 5px; }
        .history-item { border-bottom: 1px dashed rgba(255,255,255,0.2); padding: 8px 0; }
        .btn-danger { background-color: var(--primary-red); border: none; color: white; padding: 12px; margin-top: 15px; cursor: pointer; width: 100%; border-radius: 5px; font-weight: bold; letter-spacing: 1px; }
        .btn-close { background: transparent; color: var(--text-light); border: 1px solid var(--text-light); padding: 5px 15px; cursor: pointer; border-radius: 4px; }
    </style>
</head>
<body>

<div class="container">
    <div class="secret-seal" onclick="triggerAdmin()">ç¦</div>

    <div id="screen-input" class="screen active">
        <h1 class="title">é¦¬å¹´å¥½é‹å•Ÿå‹•å°</h1>
        <div class="subtitle">è½‰å‹•çš„ä¸æ˜¯é‹æ°£ï¼Œæ˜¯è¿æ¥å¥½é‹çš„å¿ƒæ„</div>
        <div class="divider"></div>
        <input type="text" id="userName" class="name-input" placeholder="è«‹å¯«ä¸‹æ‚¨çš„åå­—" maxlength="8" autocomplete="off">
        <div class="divider"></div>
        <button class="btn-primary" onclick="startSpin()">å•Ÿå‹•å¥½é‹</button>
    </div>

    <div id="screen-spin" class="screen">
        <div class="spin-circle" id="spinner">
            <div class="main-horse">é¦¬</div>
            <div class="galloping-horses">
                <span>é¦¬</span><span>é¦¬</span><span>é¦¬</span>
                <span>é¦¬</span><span>é¦¬</span><span>é¦¬</span>
            </div>
        </div>
        <div class="serif-text spin-text">è¬é¦¬å¥”é¨°ï¼Œå¥½é‹å‡èšä¸­...</div>
    </div>

    <div id="screen-result" class="screen">
        <div class="subtitle" style="margin-bottom: 10px;">ç¥ç¦å·²ç”Ÿæˆ</div>
        <h2 id="resultName" class="result-name serif-text"></h2>
        
        <div id="rewardContainer" class="reward-box">
            <div class="reward-title">ğŸ å¥½é‹å…¥æ‰‹</div>
            <div id="resultReward" class="reward-content serif-text"></div>
        </div>

        <div id="resultQuote" class="quote-text serif-text"></div>
        <div class="divider"></div>
        <button class="btn-primary" onclick="resetToHome()" style="font-size: 1rem; padding: 10px 30px;">ä¸‹ä¸€ä½æ¥å¥½é‹</button>
    </div>

    <div id="screen-admin" class="screen admin-panel">
        <div class="admin-header">
            <h2 class="serif-text" style="color:var(--accent-gold);">æ©Ÿå°æ§åˆ¶ä¸­å¿ƒ</h2>
            <button class="btn-close" onclick="resetToHome()">è¿”å›é¦–é </button>
        </div>
        
        <div style="font-size: 0.9rem; margin-bottom: 5px; opacity: 0.8;">ç›®å‰å‰©é¤˜åº«å­˜ï¼š</div>
        <div class="admin-stat-row">
            <div class="admin-stat">500å…ƒåˆ®åˆ®æ¨‚<span id="stock500">0</span></div>
            <div class="admin-stat">200å…ƒåˆ®åˆ®æ¨‚<span id="stock200">0</span></div>
        </div>

        <div class="setting-box">
            <div style="color: var(--accent-gold); margin-bottom: 10px; font-weight: bold;">âš™ï¸ é‡æ–°è¨­å®šæ´»å‹•æ•¸é‡</div>
            <div class="setting-row">
                <label>500å…ƒ åˆ®åˆ®æ¨‚ (å¼µ)ï¼š</label>
                <input type="number" id="setQty500" class="qty-input" value="3" min="0">
            </div>
            <div class="setting-row">
                <label>200å…ƒ åˆ®åˆ®æ¨‚ (å¼µ)ï¼š</label>
                <input type="number" id="setQty200" class="qty-input" value="3" min="0">
            </div>
            <button class="btn-danger" onclick="applyNewSettings()">è¼‰å…¥æ–°æ•¸é‡ä¸¦æ¸…ç©ºç´€éŒ„</button>
        </div>

        <div class="history-list" id="historyList"></div>
    </div>
</div>

<script>
    // --- å®‰å…¨è¨­å®š ---
    const ADMIN_PIN = "8888"; // å¾Œå°å¯†ç¢¼åœ¨æ­¤è¨­å®šï¼Œä¸é¡¯ç¤ºæ–¼å‰ç«¯æç¤ºä¸­

    // --- 20 å¥éå¹´å‹µå¿—é–‹é‹é‡‘å¥ ---
    const quotes = [
        "è¿å‘æ–°å±€ï¼Œæ¯ä¸€å°æ­¥éƒ½æ˜¯è¬é¦¬å¥”é¨°çš„åºæ›²ã€‚",
        "å¿ƒè‹¥ç¯¤å®šï¼Œè·¯ä¾¿å¯¬å»£ï¼›æ–°å¹´æ–°é¡˜ï¼Œå¥½é‹è‡ªä¾†ã€‚",
        "é¡˜ä½ æ–°çš„ä¸€å¹´ï¼Œæœ‰å¥”èµ´å±±æµ·çš„å‹‡æ°£ï¼Œä¹Ÿæœ‰éœå¾…èŠ±é–‹çš„å¾å®¹ã€‚",
        "ä¸ç–¾ä¸å¾ï¼Œæ­¥æ­¥ç”Ÿè“®ï¼›ä½ çš„å …æŒï¼Œçµ‚å°‡è¿ä¾†ç¾å¥½ã€‚",
        "æŠŠæœŸå¾…åŒ–ç‚ºå…·é«”çš„è¡Œå‹•ï¼Œå¥½é‹ä¾¿æœƒèˆ‡ä½ ä¸æœŸè€Œé‡ã€‚",
        "æ–°å¹´ä¸åƒ…æ˜¯æ™‚é–“çš„æ›´è¿­ï¼Œæ›´æ˜¯å¿ƒéˆèˆ‡ç›®æ¨™çš„é‡å•Ÿã€‚",
        "é¡˜ä½ å¦‚é§¿é¦¬èˆ¬æ˜‚é¦–é—Šæ­¥ï¼Œè¸ç ´ä¸€åˆ‡é›£é—œï¼Œè¿å‘è±ç››ã€‚",
        "æ™‚é–“æœƒçœ‹è¦‹æ¯ä¸€ä»½åŠªåŠ›ï¼Œæ–°çš„ä¸€å¹´ï¼Œè«‹å¤§è†½å‰è¡Œã€‚",
        "æŠŠå¸Œæœ›è£é€²è¡Œå›Šï¼Œè®“å–„æ„æˆç‚ºä½ æœ€å¼·å¤§çš„é‹æ°£ã€‚",
        "ç›¸ä¿¡è‡ªå·±ï¼Œå°±æ˜¯æ–°å¹´æœ€è±ç››ã€æœ€éˆé©—çš„é–‹é‹é…æ–¹ã€‚",
        "è¿è‘—å…‰èµ°ï¼Œå³ä½¿æ­¥ä¼ç·©æ…¢ï¼Œå‰æ–¹ä¹Ÿå¿…å®šæ˜¯ä¸€ç‰‡ç‡¦çˆ›ã€‚",
        "é¡˜æ–°å¹´çš„æ¯ä¸€å¤©ï¼Œéƒ½å¦‚æ˜¥æ—¥èˆ¬å……æ»¿ç”Ÿæ©Ÿã€ç ´åœŸè€Œå‡ºã€‚",
        "ä¸è¦å®³æ€•ç·©æ…¢ï¼Œåªè¦æ–¹å‘æ­£ç¢ºï¼Œå¥½é‹æ—©å°±ç­‰åœ¨è·¯ä¸Šã€‚",
        "æ‰€æœ‰çš„æ²‰æ¾±èˆ‡ç©ç´¯ï¼Œéƒ½æ˜¯ç‚ºäº†ä¾†æ—¥çš„è¬é¦¬å¥”é¨°ã€‚",
        "æ–°çš„ä¸€å¹´ï¼Œé¡˜ä½ è¤ªå»åŒ…è¢±ï¼Œæ´»æˆè‡ªå·±æœ€å–œæ­¡çš„æ¨¡æ¨£ã€‚",
        "è¡Œå‹•æ˜¯æœ€å¥½çš„ç ´å±€ä¹‹æ³•ï¼Œé¡˜ä½ æ–°å¹´å……æ»¿åŸ·è¡Œçš„åŠ›é‡ã€‚",
        "é‹æ°£å¾ä¾†éƒ½æ˜¯åŠªåŠ›çš„é™„å±¬å“ï¼Œè¶ŠåŠªåŠ›ï¼Œè¶Šå¹¸é‹ã€‚",
        "ä»¥æ­¡å–œå¿ƒéç”Ÿæ´»ï¼Œä»¥å¹³å¸¸å¿ƒçœ‹å‹æ•—ï¼Œå¥½é‹è‡ªç„¶æœƒæ•²é–€ã€‚",
        "é¡˜ä½ çš„æ¯ä¸€åˆ†ä»˜å‡ºï¼Œéƒ½åœ¨æ–°çš„ä¸€å¹´ç¶»æ”¾æœ€è€€çœ¼çš„å…‰èŠ’ã€‚",
        "å¸¶è‘—åˆå¿ƒå‡ºç™¼ï¼Œæ–°çš„ä¸€å¹´ï¼Œå‰ç¨‹å¿…å®šç¹èŠ±ä¼¼éŒ¦ã€‚"
    ];

    let appData = JSON.parse(localStorage.getItem('luckyDrawDataCNY_V3'));
    
    if (!appData) {
        appData = { inventory: ["500", "500", "500", "200", "200", "200"], history: [] };
        saveData();
    }

    function saveData() { localStorage.setItem('luckyDrawDataCNY_V3', JSON.stringify(appData)); }

    function switchScreen(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
    }

    function startSpin() {
        const nameInput = document.getElementById('userName').value.trim();
        if (!nameInput) {
            alert("è«‹ç•™ä¸‹æ‚¨çš„åå­—ï¼Œè®“å¥½é‹æ‰¾åˆ°æ‚¨ï¼");
            return;
        }

        switchScreen('screen-spin');
        
        const spinner = document.getElementById('spinner');
        spinner.classList.remove('spinning');
        void spinner.offsetWidth; 
        spinner.classList.add('spinning');

        // è½‰å‹• 5.5 ç§’å¾Œæ­æ›‰ï¼Œè®“åƒèˆ‡è€…å……åˆ†æ„Ÿå—å¥”é¨°ç‰¹æ•ˆ
        setTimeout(() => { showResult(nameInput); }, 5500); 
    }

    function showResult(name) {
        const finalQuote = quotes[Math.floor(Math.random() * quotes.length)];
        let finalReward = null;

        document.getElementById('resultName').innerText = `${name} çš„æ–°å¹´å¥½é‹`;

        if (appData.inventory.length > 0) {
            const randomIndex = Math.floor(Math.random() * appData.inventory.length);
            finalReward = appData.inventory.splice(randomIndex, 1)[0];
            
            const timeString = new Date().toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });
            appData.history.unshift(`${timeString} - ${name} ç²å¾— ${finalReward}å…ƒ`);
            saveData();

            document.getElementById('rewardContainer').style.display = 'block';
            document.getElementById('resultReward').innerText = `${finalReward} å…ƒ å¸Œæœ›ç„¡çª® åˆ®åˆ®æ¨‚`;
        } else {
            document.getElementById('rewardContainer').style.display = 'none';
            appData.history.unshift(`${new Date().toLocaleTimeString('zh-TW')} - ${name} (ç´”ç¥ç¦)`);
            saveData();
        }

        document.getElementById('resultQuote').innerText = `ã€Œ${finalQuote}ã€`;
        switchScreen('screen-result');
    }

    function resetToHome() {
        document.getElementById('userName').value = '';
        document.getElementById('spinner').classList.remove('spinning');
        switchScreen('screen-input');
    }

    // --- å¾Œå°é‚è¼¯ ---
    let secretClicks = 0;
    let clickTimer;

    function triggerAdmin() {
        secretClicks++;
        clearTimeout(clickTimer);
        
        if (secretClicks >= 5) {
            secretClicks = 0;
            // æç¤ºæ¡†å·²ç§»é™¤ã€Œé è¨­ 8888ã€å­—çœ¼
            const pwd = prompt("è«‹è¼¸å…¥æ©Ÿå°æ§åˆ¶ä¸­å¿ƒå¯†ç¢¼ï¼š");
            if (pwd === ADMIN_PIN) {
                renderAdmin();
                switchScreen('screen-admin');
            } else if (pwd !== null) {
                alert("å¯†ç¢¼éŒ¯èª¤");
            }
        }
        clickTimer = setTimeout(() => { secretClicks = 0; }, 2000); 
    }

    function renderAdmin() {
        const count500 = appData.inventory.filter(x => x === "500").length;
        const count200 = appData.inventory.filter(x => x === "200").length;
        
        document.getElementById('stock500').innerText = count500;
        document.getElementById('stock200').innerText = count200;

        const historyHtml = appData.history.length === 0 
            ? "<div style='opacity:0.5; text-align:center;'>å°šç„¡ç™¼æ”¾ç´€éŒ„</div>" 
            : appData.history.map(item => `<div class="history-item">${item}</div>`).join('');
        
        document.getElementById('historyList').innerHTML = historyHtml;
    }

    function applyNewSettings() {
        const qty500 = parseInt(document.getElementById('setQty500').value) || 0;
        const qty200 = parseInt(document.getElementById('setQty200').value) || 0;

        if(confirm(`ç¢ºå®šè¦é‡æ–°é–‹å§‹æ´»å‹•å—ï¼Ÿ\né€™å°‡æ¸…ç©ºæ‰€æœ‰ç™¼æ”¾ç´€éŒ„ï¼Œä¸¦è¨­å®šç‚ºï¼š\n500å…ƒ: ${qty500} å¼µ\n200å…ƒ: ${qty200} å¼µ`)) {
            let newInventory = [];
            for(let i=0; i < qty500; i++) newInventory.push("500");
            for(let i=0; i < qty200; i++) newInventory.push("200");

            appData = { inventory: newInventory, history: [] };
            saveData();
            renderAdmin();
            alert("âœ… æ•¸é‡è¨­å®šå®Œç•¢ï¼Œæ©Ÿå°å·²é‡ç½®ï¼");
        }
    }
</script>

</body>
</html>
