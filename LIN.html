<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦¬å¹´å¥½é‹å•Ÿå‹•å°ï½œé»æ“Šæ’­æ”¾èªéŸ³ç‰ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500&family=Noto+Serif+TC:wght@600;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* --- è¦–è¦ºèˆ‡è‰²ç¥¨è¨­å®š --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #7A1614 0%, #3B0A09 100%);
            --primary-red: #B22222; 
            --accent-gold: #D4AF37; 
            --text-light: #FDFBF7; 
            --bg-dark-panel: rgba(0, 0, 0, 0.55);
            --font-serif: 'Noto Serif TC', 'BiauKai', 'KaiTi', serif;
            --font-sans: 'Noto Sans TC', sans-serif;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: var(--bg-gradient); color: var(--text-light);
            font-family: var(--font-sans);
            display: flex; justify-content: center; align-items: center;
            overflow: hidden; position: relative;
        }

        .bg-watermark {
            position: absolute; width: 100%; height: 100%;
            top: 0; left: 0; z-index: 0; pointer-events: none; overflow: hidden;
        }
        .bg-watermark .char {
            position: absolute; font-family: var(--font-serif); font-weight: 900;
            color: var(--accent-gold); opacity: 0.15; text-shadow: 2px 4px 15px rgba(0,0,0,0.8); user-select: none;
        }
        .char1 { top: -2%; left: -2%; font-size: 35vh; transform: rotate(-15deg); }
        .char2 { bottom: -2%; right: -2%; font-size: 40vh; transform: rotate(10deg); }
        .char3 { top: 35%; right: 10%; font-size: 25vh; transform: rotate(-20deg); opacity: 0.1; }
        .char4 { bottom: 25%; left: 5%; font-size: 30vh; transform: rotate(15deg); opacity: 0.12; }
        .char5 { top: 10%; left: 40%; font-size: 20vh; transform: rotate(5deg); opacity: 0.08; }

        .container {
            width: 95%; max-width: 600px; height: 95vh;
            padding: 40px 20px; box-sizing: border-box;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center; position: relative; z-index: 1;
            background: rgba(40, 5, 5, 0.6);
            backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px; box-shadow: 0 15px 50px rgba(0,0,0,0.6);
        }

        .secret-seal {
            position: absolute; top: 15px; right: 15px;
            width: 36px; height: 36px;
            border: 1.5px solid var(--accent-gold); color: var(--accent-gold);
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            font-family: var(--font-serif); font-size: 1.1rem;
            opacity: 0.3; cursor: pointer; z-index: 999; transition: 0.3s;
        }
        .secret-seal:active { opacity: 1; transform: scale(0.9); }

        .screen { display: none; width: 100%; animation: fadeIn 0.8s ease; }
        .screen.active { display: flex; flex-direction: column; align-items: center; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h1, h2, .serif-text { font-family: var(--font-serif); font-weight: 600; letter-spacing: 2px; margin: 0; }
        .title { font-size: 2.8rem; color: var(--accent-gold); margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .subtitle { font-size: 1.1rem; color: var(--text-light); opacity: 0.9; margin-bottom: 50px; font-weight: 400; }
        .divider { width: 50px; height: 2px; background-color: var(--accent-gold); margin: 30px auto; opacity: 0.5; }

        .name-input {
            width: 80%; background: var(--bg-dark-panel); 
            border: 1px solid var(--accent-gold); border-radius: 8px;
            color: var(--text-light); font-size: 1.5rem; font-family: var(--font-serif);
            text-align: center; padding: 15px; box-sizing: border-box; outline: none; margin-bottom: 30px;
        }
        .name-input:focus { background: rgba(0,0,0,0.8); box-shadow: 0 0 15px rgba(212, 175, 55, 0.4); }
        .name-input::placeholder { color: rgba(253, 251, 247, 0.4); font-family: var(--font-sans); font-size: 1rem; }

        .btn-primary {
            background-color: transparent; color: var(--accent-gold);
            border: 2px solid var(--accent-gold); border-radius: 30px;
            padding: 15px 50px; font-size: 1.2rem;
            font-family: var(--font-serif); letter-spacing: 2px; cursor: pointer;
            transition: all 0.3s; background: rgba(212, 175, 55, 0.1);
        }
        .btn-primary:hover { background-color: var(--accent-gold); color: #3B0A09; font-weight: bold; }

        /* --- æ’­æ”¾èªéŸ³æŒ‰éˆ• (éš±è—/é¡¯ç¤ºæ§åˆ¶) --- */
        .btn-play-audio {
            display: none; /* é è¨­éš±è— */
            background-color: rgba(212, 175, 55, 0.15);
            color: var(--accent-gold);
            border: 1px solid var(--accent-gold);
            border-radius: 20px;
            padding: 10px 25px;
            font-size: 1rem;
            font-family: var(--font-sans);
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
            animation: pulsePlay 2s infinite;
        }
        .btn-play-audio:hover { background-color: var(--accent-gold); color: #3B0A09; }
        @keyframes pulsePlay { 0% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(212, 175, 55, 0); } 100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); } }

        /* --- è¬é¦¬å¥”é¨°åœ–ç‰‡å‹•ç•«å€ --- */
        .spin-circle {
            width: 240px; height: 240px; border: 3px dashed var(--accent-gold);
            border-radius: 50%; display: flex; justify-content: center; align-items: center;
            margin: 40px auto; background: rgba(0,0,0,0.3); position: relative;
        }
        
        .main-horse { width: 120px; height: 120px; z-index: 10; object-fit: contain; }
        .galloping-horses { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        .galloping-horses img {
            position: absolute; top: 50%; left: 50%; 
            transform: translate(-50%, -50%) scale(0); opacity: 0; object-fit: contain;
        }

        .spinning .main-horse { animation: spinAnim 5.5s cubic-bezier(0.2, 0.8, 0.3, 1) forwards; }
        .spinning .spin-circle { border-style: solid; box-shadow: 0 0 50px rgba(212, 175, 55, 0.6); transition: 0.5s; }
        
        .spinning .galloping-horses img:nth-child(1) { animation: stampede 1.4s ease-out infinite 0.1s; width: 80px; }
        .spinning .galloping-horses img:nth-child(2) { animation: stampede 1.7s ease-out infinite 0.4s; width: 130px; }
        .spinning .galloping-horses img:nth-child(3) { animation: stampede 1.2s ease-out infinite 0.8s; width: 160px; filter: brightness(1.2); }
        .spinning .galloping-horses img:nth-child(4) { animation: stampede 1.5s ease-out infinite 1.1s; width: 100px; filter: brightness(0.8); }
        .spinning .galloping-horses img:nth-child(5) { animation: stampede 1.3s ease-out infinite 1.4s; width: 140px; }

        @keyframes spinAnim { 0% { transform: rotate(0deg) scale(1); } 50% { transform: rotate(720deg) scale(1.2); } 100% { transform: rotate(1440deg) scale(1); } }
        @keyframes stampede {
            0% { transform: translate(-50%, -50%) scale(0.2); opacity: 0; }
            20% { opacity: 0.8; }
            100% { transform: translate(-50%, -50%) scale(4); opacity: 0; }
        }

        .spin-text { font-size: 1.2rem; letter-spacing: 2px; color: var(--accent-gold); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }

        /* --- çµæœç•«é¢ --- */
        .result-name { font-size: 2.2rem; color: var(--accent-gold); margin-bottom: 10px; }
        .reward-box { background: var(--bg-dark-panel); border: 1px solid var(--accent-gold); border-radius: 8px; padding: 30px; width: 85%; margin: 20px 0; }
        .reward-title { font-size: 1rem; color: var(--text-light); opacity: 0.8; margin-bottom: 10px; }
        .reward-content { font-size: 1.8rem; color: var(--accent-gold); font-weight: bold; }
        .quote-text { font-size: 1.1rem; line-height: 1.6; padding: 0 20px; margin: 30px 0 10px 0; opacity: 0.9; }
        
        .special-quote { 
            display: block; margin-top: 15px; font-size: 1.25rem; 
            color: #FFD700; font-weight: bold; text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
            animation: fadeInSparkle 1.5s ease-in-out;
            border-top: 1px dashed rgba(255, 215, 0, 0.3);
            padding-top: 15px;
        }
        @keyframes fadeInSparkle { 0% { opacity: 0; transform: scale(0.9); } 100% { opacity: 1; transform: scale(1); } }

        /* --- å¾Œå°ç®¡ç†ä»‹é¢ --- */
        .admin-panel { text-align: left; width: 95%; max-width: 500px; }
        .admin-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--accent-gold); padding-bottom: 10px; margin-bottom: 20px; }
        
        .admin-stat-row { display: flex; justify-content: space-between; margin-bottom: 10px; gap: 8px; }
        .admin-stat { background: var(--bg-dark-panel); padding: 12px 5px; border-radius: 5px; flex: 1; text-align: center; font-size: 0.9rem;}
        .admin-stat span { font-size: 1.4rem; color: var(--accent-gold); font-weight: bold; display: block; margin-top: 5px;}
        
        .setting-box { background: rgba(0,0,0,0.5); padding: 15px; border-radius: 5px; margin-top: 15px; border: 1px solid rgba(255,255,255,0.2); }
        .setting-inputs { display: flex; justify-content: space-around; flex-wrap: wrap; margin-bottom: 10px; }
        .setting-inputs label { color: var(--text-light); font-size: 0.85rem; margin: 5px 0; display: flex; align-items: center; gap: 5px;}
        .setting-inputs input { width: 45px; padding: 3px; background: transparent; border: 1px solid var(--accent-gold); color: white; text-align: center; border-radius: 3px;}
        
        .history-list { max-height: 220px; overflow-y: auto; background: rgba(0,0,0,0.6); padding: 15px; font-size: 0.9rem; margin-top: 20px; border-radius: 5px; }
        .history-item { border-bottom: 1px dashed rgba(255,255,255,0.2); padding: 12px 0; display: flex; flex-direction: column; gap: 6px; }
        .history-main { font-weight: bold; color: var(--text-light); font-size: 1rem; }
        .history-main span { color: var(--accent-gold); }
        .history-quote { color: var(--accent-gold); opacity: 0.85; font-size: 0.85rem; line-height: 1.4; }
        
        .btn-danger { background-color: var(--primary-red); border: none; color: white; padding: 12px; margin-top: 5px; cursor: pointer; width: 100%; border-radius: 5px; font-weight: bold; letter-spacing: 1px; }
        .btn-close { background: transparent; color: var(--text-light); border: 1px solid var(--text-light); padding: 5px 15px; cursor: pointer; border-radius: 4px; }
    </style>
</head>
<body>

<div class="bg-watermark">
    <div class="char char1">ç¦</div>
    <div class="char char2">æ˜¥</div>
    <div class="char char3">å‰</div>
    <div class="char char4">è²¡</div>
    <div class="char char5">æ»¿</div>
</div>

<div class="container">
    <div class="secret-seal" onclick="triggerAdmin()">ç¦</div>

    <div id="screen-input" class="screen active">
        <h1 class="title">2026é¦¬å¹´<br>å¥½é‹å•Ÿå‹•å°</h1>
        <div class="subtitle">è½‰å‹•çš„ä¸æ˜¯é‹æ°£ï¼Œæ˜¯è¿æ¥å¥½é‹çš„å¿ƒæ„</div>
        <div class="divider"></div>
        <input type="text" id="userName" class="name-input" placeholder="è«‹å¯«ä¸‹æ‚¨çš„åå­—" maxlength="8" autocomplete="off">
        <div class="divider"></div>
        <button class="btn-primary" onclick="startSpin()">å•Ÿå‹•å¥½é‹</button>
    </div>

    <div id="screen-spin" class="screen">
        <div class="spin-circle" id="spinner">
            <img src="https://img.icons8.com/ios-filled/256/D4AF37/horse.png" class="main-horse" alt="é‡‘é¦¬">
            <div class="galloping-horses">
                <img src="https://img.icons8.com/ios-filled/256/D4AF37/horse.png" alt="é¦¬">
                <img src="https://img.icons8.com/ios-filled/256/D4AF37/horse.png" alt="é¦¬">
                <img src="https://img.icons8.com/ios-filled/256/D4AF37/horse.png" alt="é¦¬">
                <img src="https://img.icons8.com/ios-filled/256/D4AF37/horse.png" alt="é¦¬">
                <img src="https://img.icons8.com/ios-filled/256/D4AF37/horse.png" alt="é¦¬">
            </div>
        </div>
        <div class="serif-text spin-text">è¬é¦¬å¥”é¨°ï¼Œå¥½é‹å‡èšä¸­...</div>
    </div>

    <div id="screen-result" class="screen">
        <div class="subtitle" style="margin-bottom: 10px;">ç¥ç¦å·²ç”Ÿæˆ</div>
        <h2 id="resultName" class="result-name serif-text"></h2>
        
        <div id="rewardContainer" class="reward-box">
            <div class="reward-title">ğŸ å¥½é‹å…¥æ‰‹</div>
            <div id="resultReward" class="reward-content serif-text"></div>
        </div>

        <div id="resultQuote" class="quote-text serif-text"></div>
        
        <button id="btnPlayAudio" class="btn-play-audio" onclick="playSecretAudio()">ğŸ”Š è†è½å°ˆå±¬ç¥ç¦</button>

        <div class="divider"></div>
        <button class="btn-primary" onclick="resetToHome()" style="font-size: 1rem; padding: 10px 30px;">ä¸‹ä¸€ä½æ¥å¥½é‹</button>
    </div>

    <div id="screen-admin" class="screen admin-panel">
        <div class="admin-header">
            <h2 class="serif-text" style="color:var(--accent-gold);">æ©Ÿå°æ§åˆ¶ä¸­å¿ƒ</h2>
            <button class="btn-close" onclick="resetToHome()">è¿”å›é¦–é </button>
        </div>
        
        <div style="font-size: 0.9rem; margin-bottom: 5px; opacity: 0.8;">ç›®å‰å‰©é¤˜åº«å­˜ï¼š</div>
        <div class="admin-stat-row">
            <div class="admin-stat">500å…ƒ<span id="stock500">0</span></div>
            <div class="admin-stat">200å…ƒ<span id="stock200">0</span></div>
            <div class="admin-stat">100å…ƒ<span id="stock100">0</span></div>
        </div>

        <div class="history-list" id="historyList"></div>

        <div class="setting-box">
            <div class="setting-inputs">
                <label>500å…ƒï¼š <input type="number" id="setQty500" value="3" min="0"></label>
                <label>200å…ƒï¼š <input type="number" id="setQty200" value="3" min="0"></label>
                <label>100å…ƒï¼š <input type="number" id="setQty100" value="3" min="0"></label>
            </div>
            <button class="btn-danger" onclick="applyNewSettings()">è¼‰å…¥æ–°æ•¸é‡ä¸¦æ¸…ç©ºç´€éŒ„</button>
        </div>
    </div>
</div>

<script>
    const ADMIN_PIN = "8888"; 
    
    let currentAudio = null; // å­˜æ”¾ç•¶å‰çš„éŸ³æ¨‚ç‰©ä»¶

    // ğŸŒŸ å®¶æ—å°ˆå±¬ VIP ç¥ç¦å½©è›‹åå–® ğŸŒŸ
    const specialGuests = {
        "è¯å“¥": "âœ¨ è¶Šä¾†è¶Šå¸¥é‚„ç˜¦èº«æˆåŠŸï¼Œæ ¹æœ¬é€†é½¡ç¤ºç¯„çµ„ã€‚è²¡åº«è£œå¥½ã€æ°£è‰²ç™¼å…‰ï¼Œä¸™åˆå¹´æ—ºåˆ°åƒé–‹å¤–æ›ï¼Œé€£èŠåˆè‡ªæ‘¸åªæ˜¯æ—¥å¸¸ï¼Œå…¨å®¶æœ€ç©©é å±±ã€‚",
        "æƒ ç¾": "âœ¨ æ°£è³ªå¥½åˆ°è‡ªå¸¶æŸ”ç„¦æ¿¾é¡ï¼Œç¥ä¼¼æ—å¿—ç²çš„å„ªé›…èˆ‡å¾å®¹ã€‚åœ‹æ¨™100åˆ†ã€å›é ­ç‡200%ï¼Œè¦ªæˆšéƒ½åœ¨å•ï¼šé€™ä½å¥³ç¥é‚„æ”¶ä¸æ”¶ç²‰çµ²ï¼Ÿèµ°åˆ°å“ªéƒ½æ˜¯ç„¦é»ï¼Œé›£æ€ªäººäººæ¶è‘—æ¬£è³èˆ‡é è¿‘ã€‚",
        "è¨±æœˆ": "âœ¨ å¯æ„›åˆæ…ˆå–„ï¼Œç¬‘å®¹ä¸€å‡ºå°±è®“äººå®‰å¿ƒã€‚å®¶ä¸­çœŸæ­£çš„æ‰›æŠŠå­ï¼Œæº«æš–åˆæœ‰æ™ºæ…§ï¼Œèªªè©±å°±æ˜¯æˆäº¤ï¼Œæ ¹æœ¬å¤©ç”Ÿçš„éŠ·å”®é«˜æ‰‹ã€‚",
        "æ´µ": "âœ¨ ç±ƒçƒã€ç¾½çƒã€ç¶²çƒæ¨£æ¨£ä¾†ï¼Œé‹å‹•é ç†±æƒ…ä¸é å¤©åˆ†ã€‚å˜´ä¸Šä¸èªªï¼Œè¡Œå‹•æœ€èª å¯¦ï¼›å®¶äººæ˜¯æœ€æ„›ã€‚",
        "æ°¸åœ‹": "âœ¨ å°é…’çª©ä¸€ç¬‘å¤§å®¶å…ˆæŠ•é™ï¼Œæ°´é›»ç¶­ä¿®ç›´æ¥å…¨åŒ…ã€‚ç´ é£Ÿæ—©é¤æ‰‹è—ç´®å¯¦åˆç”¨å¿ƒï¼ŒæŠ€è¡“èˆ‡èƒƒå£é›™æ»¿è¶³ï¼Œæ‰‹è—å¥½ã€å¿ƒä¹Ÿæš–ï¼Œæ˜¯ç”Ÿæ´»ç³»ç”·ç¥ã€‚",
        "é¼ä¾†": "âœ¨ å¸¥æ°£å°±æ˜¯ä½ çš„è¶…èƒ½åŠ›ï¼Œä¸ç”¨å¤šèªªå·²ç¶“å…¨å ´ç„¦é»ã€‚å¤§å®¶ä¸æ¶æ¼”å”±æœƒé–€ç¥¨ï¼Œåªæƒ³çœ‹ä½ æœ¬äººå‡ºç¾ï¼Œå­˜åœ¨æ„Ÿç›´æ¥æ‹‰æ»¿ã€‚",
        "æ¬Šé™": "âœ¨ æº«æŸ”åˆæœ‰æ„›å¿ƒã€çœ¼ç¥æº«æš–ã€‚é€£å°è²“å’ªéƒ½çŸ¥é“èª°æœ€å€¼å¾—ä¾é ï¼Œè‡ªç„¶é»ä¸Šä½ ï¼Œå¥½äººå“ä¸€çœ¼å°±çœ‹å¾—å‡ºä¾†ã€‚",
        "å‹å®": "âœ¨ é‹å‹•é«˜æ‰‹ï¼Œä»€éº¼éƒ½æœƒä¸€é»é‚„éƒ½å¾ˆå¼·ã€‚æ¨£æ¨£ç²¾é€šæ¯«ä¸å¼µæšã€‚å¸¥æ°£å¤–è¡¨ä¸‹æ˜¯è‡ªå¾‹èˆ‡è‡ªä¿¡ï¼Œç«™åœ¨é‚£è£¡å°±è®“äººå¿ä¸ä½æ¬£è³ã€‚",
        "å¥•å»·": "âœ¨ ç¬‘å®¹ä¹¾æ·¨åˆå¯æ„›ï¼Œåƒé™½å…‰ä¸€æ¨£è®“äººå¿ƒæƒ…è®Šå¥½ã€‚ä¸è²»åŠ›å°±è¿·å€’çœ¾ç”Ÿï¼Œæ˜¯å¤©ç”Ÿè‡ªå¸¶å¥½æ„Ÿåº¦çš„å°å¤ªé™½ï¼Œæ˜¯æœªä¾†ç´…åŒ…æœ€å¤šçš„æ½›åŠ›è‚¡ã€‚",
        "å¦™å¨Ÿ": "âœ¨ ç´°å¿ƒæº«æŸ”åˆ°è‡ªå¸¶å®‰æ’«åŠŸèƒ½ï¼Œè²éŸ³ä¸€å‡ºå…¨å ´é™å™ªã€‚å­«å¥³è‡ªå‹•é»ç·Šç·Šï¼Œè€å¿ƒèˆ‡æ„›è—åœ¨ç´°ç¯€è£¡ï¼Œé›£æ€ªæˆç‚ºå­«å¥³å¿ƒä¸­æœ€å®‰å¿ƒçš„å­˜åœ¨ã€‚",
        "éƒé›¯": "âœ¨ æ¼‚äº®åˆæœ‰æ„›çš„è­·ç†å¸«ï¼Œè‡ªå¸¶å®‰å¿ƒæ„Ÿå…‰ç’°ã€‚æ±è¥¿æ•´ç†å¾—ä¹¾ä¹¾æ·¨æ·¨ï¼Œé€£ç©ºæ°£éƒ½å¾ˆæœ‰ç§©åºï¼Œæ˜¯äººç¾å¿ƒç´°çš„æœ€ä½³ä»£è¡¨ã€‚",
        "çœŸå¦®": "âœ¨ è­¦ç•Œæ ¡èŠ±æœ¬äººç„¡èª¤ï¼Œé¡å€¼åœ¨ç·šã€æ°£è³ªæº«æŸ”ã€‚ç«™åœ¨é‚£è£¡å°±å¾ˆæ­£ç¾©ï¼Œè®“äººæ‡·ç–‘æ˜¯ä¸æ˜¯åˆ¶æœæœ¬èº«éƒ½åœ¨åŠ åˆ†ã€‚",
        "å½¬": "âœ¨ å¸¥æ°£ç©©é‡ï¼Œç¾½çƒå ´ä¸Šçš„å¯¦åŠ›æ´¾ã€‚äº‹æ¥­èˆ‡çƒæŠ€åŒæ­¥æˆé•·ï¼Œæ˜¯è®“äººæ”¾å¿ƒåˆå€¼å¾—æ­å–œçš„å­˜åœ¨ã€‚",
        "è•è•": "âœ¨ å…©æ­²å°±å¯æ„›åˆ°çŠ¯è¦ï¼Œæ„›é‹å‹•ã€æ´»åŠ›æ»¿æ»¿ã€‚ä¸€é›™è¿·äººçœ¼ç›ç¬‘èµ·ä¾†ï¼Œå…¨å ´è‡ªå‹•èåŒ–ï¼Œå®Œå…¨æ˜¯å®¶æ—é–‹å¿ƒæœã€‚",
        "æ„›ç¾": "âœ¨ å¯æ„›åˆå‹•äººï¼Œå­¸ç¿’åŠ›å¼·åˆ°è®“äººä½©æœï¼Œæ˜“ç¶“ç ”ç©¶å¾—é ­é ­æ˜¯é“ã€‚ç•¶ç­é•·æ ¹æœ¬çœ¾æœ›æ‰€æ­¸ï¼Œèµ°åˆ°å“ªéƒ½è‡ªå¸¶èšå…‰ç‡ˆï¼Œæ˜¯å®¶æ—æœ€äº®çš„ä¸€é¡†æ˜Ÿã€‚",
        "å½¥ç¶¸": "âœ¨ è¶Šä¾†è¶Šå¹´è¼•ï¼Œé»‘é ­é«®æ‚„æ‚„å›æ­¸ï¼Œé€£é»‘æ–‘éƒ½æ‡‚å¾—è‡ªå‹•æ·¡å‡ºã€‚é çš„ä¸æ˜¯ä¿é¤Šå“ï¼Œæ˜¯å¤šå¹´å …æŒèˆ‡æ¯…åŠ›ï¼Œæ–°çš„ä¸€å¹´ç¹¼çºŒå¸¥å¾—å¾ˆæœ‰åº•æ°£ã€‚",
        "ç¾æ€¡": "âœ¨ ç¾éº—æœ‰æ°£è³ªï¼Œè‡ªå¸¶å¥³ç¥å…‰ç’°ï¼Œå¹¼ç¨šåœ’å°æœ‹å‹æ¶è‘—æŠ±ã€‚ç±ƒçƒå ´ä¸Šçš„æ“¦æ¿å¥³ç‹ï¼Œå®¶ä¸­å°ç”œå¿ƒå…¼è»å¸«ï¼Œæ–°çš„ä¸€å¹´ç¹¼çºŒç”¨é­…åŠ›èˆ‡æ™ºæ…§æ”¶æœå…¨å ´ã€‚ã€‚"
        "æ¯“ç§€": "âœ¨ è²éŸ³æº«æŸ”è®“äººä¸€è½å°±å®‰å¿ƒï¼Œå»šè—å¥½åˆ°å¤§å®¶è‡ªå‹•åŠ é£¯ã€‚æ­Œè²æ‚…è€³ã€åˆç†±æ„›çˆ¬å±±ï¼Œæ˜¯èƒ½æŠŠç”Ÿæ´»éå¾—åˆæš–åˆå¥åº·çš„ä»£è¡¨ã€‚"
    };

    const quotes = [
        "è¿å‘æ–°å±€ï¼Œæ¯ä¸€å°æ­¥éƒ½æ˜¯è¬é¦¬å¥”é¨°çš„åºæ›²ã€‚",
        "å¿ƒè‹¥ç¯¤å®šï¼Œè·¯ä¾¿å¯¬å»£ï¼›æ–°å¹´æ–°é¡˜ï¼Œå¥½é‹è‡ªä¾†ã€‚",
        "é¡˜ä½ æ–°çš„ä¸€å¹´ï¼Œæœ‰å¥”èµ´å±±æµ·çš„å‹‡æ°£ï¼Œä¹Ÿæœ‰éœå¾…èŠ±é–‹çš„å¾å®¹ã€‚",
        "ä¸ç–¾ä¸å¾ï¼Œæ­¥æ­¥ç”Ÿè“®ï¼›ä½ çš„å …æŒï¼Œçµ‚å°‡è¿ä¾†ç¾å¥½ã€‚",
        "æŠŠæœŸå¾…åŒ–ç‚ºå…·é«”çš„è¡Œå‹•ï¼Œå¥½é‹ä¾¿æœƒèˆ‡ä½ ä¸æœŸè€Œé‡ã€‚",
        "æ–°å¹´ä¸åƒ…æ˜¯æ™‚é–“çš„æ›´è¿­ï¼Œæ›´æ˜¯å¿ƒéˆèˆ‡ç›®æ¨™çš„é‡å•Ÿã€‚",
        "é¡˜ä½ å¦‚é§¿é¦¬èˆ¬æ˜‚é¦–é—Šæ­¥ï¼Œè¸ç ´ä¸€åˆ‡é›£é—œï¼Œè¿å‘è±ç››ã€‚",
        "æ™‚é–“æœƒçœ‹è¦‹æ¯ä¸€ä»½åŠªåŠ›ï¼Œæ–°çš„ä¸€å¹´ï¼Œè«‹å¤§è†½å‰è¡Œã€‚",
        "æŠŠå¸Œæœ›è£é€²è¡Œå›Šï¼Œè®“å–„æ„æˆç‚ºä½ æœ€å¼·å¤§çš„é‹æ°£ã€‚",
        "ç›¸ä¿¡è‡ªå·±ï¼Œå°±æ˜¯æ–°å¹´æœ€è±ç››ã€æœ€éˆé©—çš„é–‹é‹é…æ–¹ã€‚",
        "è¿è‘—å…‰èµ°ï¼Œå³ä½¿æ­¥ä¼ç·©æ…¢ï¼Œå‰æ–¹ä¹Ÿå¿…å®šæ˜¯ä¸€ç‰‡ç‡¦çˆ›ã€‚",
        "é¡˜æ–°å¹´çš„æ¯ä¸€å¤©ï¼Œéƒ½å¦‚æ˜¥æ—¥èˆ¬å……æ»¿ç”Ÿæ©Ÿã€ç ´åœŸè€Œå‡ºã€‚",
        "ä¸è¦å®³æ€•ç·©æ…¢ï¼Œåªè¦æ–¹å‘æ­£ç¢ºï¼Œå¥½é‹æ—©å°±ç­‰åœ¨è·¯ä¸Šã€‚",
        "æ‰€æœ‰çš„æ²‰æ¾±èˆ‡ç©ç´¯ï¼Œéƒ½æ˜¯ç‚ºäº†ä¾†æ—¥çš„è¬é¦¬å¥”é¨°ã€‚",
        "æ–°çš„ä¸€å¹´ï¼Œé¡˜ä½ è¤ªå»åŒ…è¢±ï¼Œæ´»æˆè‡ªå·±æœ€å–œæ­¡çš„æ¨¡æ¨£ã€‚",
        "è¡Œå‹•æ˜¯æœ€å¥½çš„ç ´å±€ä¹‹æ³•ï¼Œé¡˜ä½ æ–°å¹´å……æ»¿åŸ·è¡Œçš„åŠ›é‡ã€‚",
        "é‹æ°£å¾ä¾†éƒ½æ˜¯åŠªåŠ›çš„é™„å±¬å“ï¼Œè¶ŠåŠªåŠ›ï¼Œè¶Šå¹¸é‹ã€‚",
        "ä»¥æ­¡å–œå¿ƒéç”Ÿæ´»ï¼Œä»¥å¹³å¸¸å¿ƒçœ‹å‹æ•—ï¼Œå¥½é‹è‡ªç„¶æœƒæ•²é–€ã€‚",
        "é¡˜ä½ çš„æ¯ä¸€åˆ†ä»˜å‡ºï¼Œéƒ½åœ¨æ–°çš„ä¸€å¹´ç¶»æ”¾æœ€è€€çœ¼çš„å…‰èŠ’ã€‚",
        "å¸¶è‘—åˆå¿ƒå‡ºç™¼ï¼Œæ–°çš„ä¸€å¹´ï¼Œå‰ç¨‹å¿…å®šç¹èŠ±ä¼¼éŒ¦ã€‚"
    ];

    let appData = JSON.parse(localStorage.getItem('luckyDrawDataCNY_V11'));
    
    if (!appData) {
        appData = { 
            inventory: ["500", "500", "500", "200", "200", "200", "100", "100", "100"], 
            history: [] 
        };
        saveData();
    }

    function saveData() { localStorage.setItem('luckyDrawDataCNY_V11', JSON.stringify(appData)); }

    function switchScreen(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
    }

    function startSpin() {
        const nameInput = document.getElementById('userName').value.trim();
        if (!nameInput) {
            alert("è«‹ç•™ä¸‹æ‚¨çš„åå­—ï¼Œè®“å¥½é‹æ‰¾åˆ°æ‚¨ï¼");
            return;
        }

        switchScreen('screen-spin');
        
        const spinner = document.getElementById('spinner');
        spinner.classList.remove('spinning');
        void spinner.offsetWidth; 
        spinner.classList.add('spinning');

        setTimeout(() => { showResult(nameInput); }, 5500); 
    }

    function showResult(name) {
        let finalQuote = quotes[Math.floor(Math.random() * quotes.length)];
        let finalReward = null;
        let rewardText = "ç´”ç¥ç¦";
        
        // æ¯æ¬¡é¡¯ç¤ºæ–°çµæœå‰ï¼Œå…ˆéš±è—æ’­æ”¾æŒ‰éˆ•
        const btnPlayAudio = document.getElementById('btnPlayAudio');
        btnPlayAudio.style.display = 'none';

        document.getElementById('resultName').innerText = `${name} çš„æ–°å¹´å¥½é‹`;

        if (appData.inventory.length > 0) {
            const randomIndex = Math.floor(Math.random() * appData.inventory.length);
            finalReward = appData.inventory.splice(randomIndex, 1)[0];
            rewardText = `${finalReward}å…ƒ`;

            document.getElementById('rewardContainer').style.display = 'block';
            document.getElementById('resultReward').innerText = `${finalReward} å…ƒ å¸Œæœ›ç„¡çª® åˆ®åˆ®æ¨‚`;
        } else {
            document.getElementById('rewardContainer').style.display = 'none';
        }

        const timeString = new Date().toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });
        appData.history.unshift({
            time: timeString, name: name, reward: rewardText, quote: finalQuote
        });
        saveData();

        // ğŸŒŸ çµ„åˆé‡‘å¥é¡¯ç¤ºå…§å®¹ ğŸŒŸ
        let quoteHtml = `ã€Œ${finalQuote}ã€`;
        if (specialGuests[name]) {
            quoteHtml += `<span class="special-quote">${specialGuests[name]}</span>`;
            
            // ç³»çµ±åœ¨èƒŒæ™¯å·å·æº–å‚™å¥½éŸ³æª”ï¼Œä½†ä¸è‡ªå‹•æ’­æ”¾
            try {
                let audioFileName = name + ".mp3"; 
                currentAudio = new Audio(audioFileName);
                // é¡¯ç¤ºæ’­æ”¾æŒ‰éˆ•ï¼Œè®“å®¶äººè‡ªå·±æ±ºå®šä½•æ™‚é»æ“Š
                btnPlayAudio.style.display = 'inline-block';
            } catch (error) {
                console.log("éŸ³æ•ˆæº–å‚™å¤±æ•—");
            }
        }
        
        document.getElementById('resultQuote').innerHTML = quoteHtml;
        switchScreen('screen-result');
    }

    // ğŸŒŸ é»æ“ŠæŒ‰éˆ•å¾ŒåŸ·è¡Œæ’­æ”¾ ğŸŒŸ
    function playSecretAudio() {
        if (currentAudio) {
            // å¦‚æœéŸ³æ¨‚æ­£åœ¨æ’­ï¼Œå°±é‡é ­æ’­
            currentAudio.currentTime = 0;
            currentAudio.play().catch(e => {
                alert("æ’­æ”¾å¤±æ•—ï¼Œè«‹ç¢ºèªæ‰‹æ©Ÿ/å¹³æ¿æ˜¯å¦é–‹å•ŸéœéŸ³ï¼Œæˆ–éŸ³æª”æ˜¯å¦å·²ä¸Šå‚³ã€‚");
            });
        }
    }

    function resetToHome() {
        // é»æ“Šä¸‹ä¸€ä½æ™‚ï¼Œé—œé–‰è²éŸ³
        if (currentAudio) {
            currentAudio.pause();
            currentAudio.currentTime = 0;
            currentAudio = null;
        }

        document.getElementById('userName').value = '';
        document.getElementById('spinner').classList.remove('spinning');
        switchScreen('screen-input');
    }

    // --- å¾Œå°ç®¡ç†å€ ---
    let secretClicks = 0;
    let clickTimer;

    function triggerAdmin() {
        secretClicks++;
        clearTimeout(clickTimer);
        
        if (secretClicks >= 5) {
            secretClicks = 0;
            const pwd = prompt("è«‹è¼¸å…¥æ©Ÿå°æ§åˆ¶ä¸­å¿ƒå¯†ç¢¼ï¼š");
            if (pwd === ADMIN_PIN) {
                renderAdmin();
                switchScreen('screen-admin');
            } else if (pwd !== null) {
                alert("å¯†ç¢¼éŒ¯èª¤");
            }
        }
        clickTimer = setTimeout(() => { secretClicks = 0; }, 2000); 
    }

    function renderAdmin() {
        const count500 = appData.inventory.filter(x => x === "500").length;
        const count200 = appData.inventory.filter(x => x === "200").length;
        const count100 = appData.inventory.filter(x => x === "100").length;
        
        document.getElementById('stock500').innerText = count500;
        document.getElementById('stock200').innerText = count200;
        document.getElementById('stock100').innerText = count100;

        const historyHtml = appData.history.length === 0 
            ? "<div style='opacity:0.5; text-align:center;'>å°šç„¡ç™¼æ”¾ç´€éŒ„</div>" 
            : appData.history.map(item => `
                <div class="history-item">
                    <div class="history-main">${item.time} - <span>${item.name}</span> ç²å¾— ${item.reward}</div>
                    <div class="history-quote">ã€Œ${item.quote}ã€</div>
                </div>
            `).join('');
        
        document.getElementById('historyList').innerHTML = historyHtml;
    }

    function applyNewSettings() {
        const qty500 = parseInt(document.getElementById('setQty500').value) || 0;
        const qty200 = parseInt(document.getElementById('setQty200').value) || 0;
        const qty100 = parseInt(document.getElementById('setQty100').value) || 0;

        if(confirm(`ç¢ºå®šè¦é‡æ–°é–‹å§‹æ´»å‹•å—ï¼Ÿ\né€™å°‡æ¸…ç©ºæ‰€æœ‰ç´€éŒ„ï¼Œä¸¦è¨­å®šç‚ºï¼š\n500å…ƒ: ${qty500}å¼µ\n200å…ƒ: ${qty200}å¼µ\n100å…ƒ: ${qty100}å¼µ`)) {
            let newInventory = [];
            for(let i=0; i < qty500; i++) newInventory.push("500");
            for(let i=0; i < qty200; i++) newInventory.push("200");
            for(let i=0; i < qty100; i++) newInventory.push("100");

            appData = { inventory: newInventory, history: [] };
            saveData();
            renderAdmin();
            alert("âœ… æ•¸é‡è¨­å®šå®Œç•¢ï¼Œæ©Ÿå°å·²é‡ç½®ï¼");
        }
    }
</script>

</body>
</html>
