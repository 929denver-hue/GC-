<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>72æ³•å‰‡å¯¦æ¸¬-ç†è²¡æ–¹æ¡ˆå°æ¯” (å¯¦è³ªåƒ¹å€¼ç‰ˆ)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* åŸºç¤æ¨£å¼èˆ‡å¡ç‰‡è¨­è¨ˆ */
        body { font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; background: #f4f6f9; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); max-width: 1000px; margin: auto; }
        
        .input-card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .card { padding: 15px; border-radius: 10px; border: 1px solid #ddd; background: #fff; }
        .card.plan-a { border-top: 5px solid #34a853; }
        .card.plan-b { border-top: 5px solid #4285f4; }
        .card.plan-c { border-top: 5px solid #fabc05; }
        .card.inflation { border-top: 5px solid #ea4335; background: #fff5f5; }
        
        label { font-size: 0.85rem; font-weight: bold; color: #555; }
        input { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        
        button { width: 100%; padding: 15px; background: #202124; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; transition: 0.3s; font-weight: bold; }
        button:hover { background: #d93025; }

        .chart-container { height: 500px; margin-top: 30px; position: relative; }

        /* è‡ªå‹•æ‘˜è¦å ±å‘Šå€å¡Š */
        .summary-box { margin-top: 30px; padding: 20px; background: #f0f7ff; border-radius: 12px; border: 1px solid #d0e3ff; }
        .summary-box h3 { margin: 0 0 10px 0; color: #1a73e8; }
        .summary-item { margin-bottom: 8px; line-height: 1.6; color: #333; }
        .highlight-red { color: #d93025; font-weight: bold; }
        .highlight-green { color: #188038; font-weight: bold; }

        /* çŸ¥è­˜åº«æ¨£å¼ */
        .knowledge-base { margin-top: 40px; padding: 25px; background: #f8faff; border: 1px solid #e8f0fe; border-radius: 12px; }
        .knowledge-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .formula-box { background: #1a73e8; color: #fff; text-align: center; padding: 15px; font-size: 1.5rem; font-weight: bold; border-radius: 8px; margin: 20px 0; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .ref-link { padding: 8px 16px; background-color: #fff; color: #1a73e8; border: 2px solid #1a73e8; border-radius: 20px; text-decoration: none; font-weight: bold; transition: 0.3s; }
        .ref-link:hover { background-color: #1a73e8; color: white; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align:center;">ğŸ“‰ å¯¦è³ªè³¼è²·åŠ›å°æ¯” (72æ³•å‰‡æ‡‰ç”¨)</h1>
    <p style="text-align:center; color: #666;">æœ¬å·¥å…·å°‡æ‰€æœ‰æ”¶ç›Šæ‰£é™¤é€šè†¨ï¼Œé¡¯ç¤ºè³‡ç”¢åœ¨æœªä¾†çš„ã€ŒçœŸå¯¦åƒ¹å€¼ã€</p>
    
    <div class="input-card-grid">
        <div class="card plan-a"><h4>æ–¹æ¡ˆ A</h4><label>å¹´åˆ©ç‡ (%)</label><input type="number" id="rateA" value="1.5"></div>
        <div class="card plan-b"><h4>æ–¹æ¡ˆ B</h4><label>å¹´åˆ©ç‡ (%)</label><input type="number" id="rateB" value="6"></div>
        <div class="card plan-c"><h4>æ–¹æ¡ˆ C</h4><label>å¹´åˆ©ç‡ (%)</label><input type="number" id="rateC" value="10"></div>
        <div class="card inflation"><h4>âš ï¸ å…¨å±€é€šè†¨</h4><label>å¹´é€šè†¨ (%)</label><input type="number" id="rateInf" value="3"><label>æ¨¡æ“¬å¹´æ•¸</label><input type="number" id="years" value="35"></div>
    </div>

    <div style="margin-bottom: 20px;">
        <label>åˆå§‹æœ¬é‡‘ (è¬å…ƒ)ï¼š</label>
        <input type="number" id="principal" value="100" style="width: 200px;">
    </div>

    <button onclick="updateComparisonChart()">å³æ™‚åˆ†æå¯¦è³ªè²¡å¯Œè®Šå‹•</button>

    <div id="summaryReport" class="summary-box" style="display:none;">
        <h3>ğŸ“Š æ™ºæ…§åˆ†ææ‘˜è¦</h3>
        <div id="summaryContent"></div>
    </div>

    <div class="chart-container"><canvas id="compChart"></canvas></div>

    <div class="knowledge-base">
        <div class="knowledge-header">
            <h2>ğŸ“˜ 72 æ³•å‰‡æ·±åº¦è§£æ</h2>
            <a href="https://drive.google.com/file/d/1Lp3iPBmWRkoDQGOWY4qatXjCzYY7YlVe/view?usp=sharing" target="_blank" class="ref-link">ğŸ”— æŸ¥çœ‹è©³ç´°èªªæ˜æ–‡ä»¶</a>
        </div>
        <p>72 æ³•å‰‡æ˜¯ç†è²¡ä¸­æœ€ç›´è¦ºçš„ã€Œå¿ƒç®—å·¥å…·ã€ã€‚åœ¨æ­¤åœ–è¡¨ä¸­ï¼Œ<strong>åœ“åœˆæ¨™è¨˜</strong>ä»£è¡¨æ‚¨çš„ã€Œåç›®è³‡ç”¢ã€ç¿»å€çš„å¹´ä»½ã€‚</p>
        <div class="formula-box">ç¿»å€å¹´æ•¸ â‰ˆ 72 Ã· å¹´åŒ–å ±é…¬ç‡ (%)</div>
        <div class="info-grid">
            <div class="info-item">
                <h4>ğŸ¤” ç‚ºä»€éº¼è¦çœ‹å¯¦è³ªåƒ¹å€¼ï¼Ÿ</h4>
                <p>åªæœ‰ç•¶å›å ±ç‡å¤§æ–¼é€šè†¨æ™‚ï¼Œæ‚¨çš„è²¡å¯Œæ‰ç®—çœŸæ­£å¢é•·ã€‚è‹¥å…©è€…ç›¸ç­‰ï¼Œæ‚¨çš„è³¼è²·åŠ›åƒ…åƒ…æ˜¯åŸåœ°è¸æ­¥ã€‚</p>
            </div>
            <div class="info-item">
                <h4>ğŸš€ è¤‡åˆ©èˆ‡è¡Œå‹•å»ºè­°</h4>
                <p>1. <strong>è¤‡åˆ©æ˜¯å‰æï¼š</strong> å¿…é ˆåˆ©æ»¾åˆ©æ‰æº–ç¢ºã€‚<br>2. <strong>è­¦æƒ•é€šè†¨ï¼š</strong> å ±é…¬ç‡ä½æ–¼é€šè†¨çš„æ–¹æ¡ˆï¼Œæ›²ç·šæœƒå‘ä¸‹èµ°ã€‚</p>
            </div>
        </div>
    </div>
</div>

<script>
    let compChart = null;

    function updateComparisonChart() {
        const p = parseFloat(document.getElementById('principal').value);
        const y = parseInt(document.getElementById('years').value);
        const infRate = parseFloat(document.getElementById('rateInf').value) / 100;
        
        const rates = [
            { id: 'rateA', name: 'æ–¹æ¡ˆ A', color: '#34a853' },
            { id: 'rateB', name: 'æ–¹æ¡ˆ B', color: '#4285f4' },
            { id: 'rateC', name: 'æ–¹æ¡ˆ C', color: '#fabc05' }
        ];

        const labels = Array.from({length: y + 1}, (_, i) => `ç¬¬ ${i} å¹´`);
        const reportData = [];

        const datasets = rates.map(r => {
            const rVal = parseFloat(document.getElementById(r.id).value) / 100;
            const rValPercent = rVal * 100;
            const doubleYear = rValPercent > 0 ? 72 / rValPercent : null;
            const data = [];
            const pointRadius = [];
            
            for(let i=0; i<=y; i++) {
                // å¯¦è³ªåƒ¹å€¼è¨ˆç®—å…¬å¼ï¼šP * [(1+r) / (1+inf)]^n
                const realVal = p * Math.pow((1 + rVal) / (1 + infRate), i);
                data.push(realVal.toFixed(2));
                // æ¨™è¨˜åç›®ç¿»å€é»
                pointRadius.push(doubleYear && Math.abs(i - doubleYear) < 0.5 && i > 0 ? 8 : 0);
            }
            
            reportData.push({ name: r.name, final: data[y], rate: rValPercent });

            return {
                label: `${r.name} (å¯¦è³ªåˆ©ç‡: ${(rValPercent - infRate*100).toFixed(1)}%)`,
                data: data,
                borderColor: r.color,
                pointBackgroundColor: r.color,
                pointRadius: pointRadius,
                pointHoverRadius: 12,
                tension: 0.3,
                fill: false
            };
        });

        // åŸºæº–ç·š (100è¬è³¼è²·åŠ›)
        datasets.push({
            label: 'è³¼è²·åŠ›åŸºæº–ç·š (ä¸è®Š)',
            data: Array(y+1).fill(p),
            borderColor: '#000',
            borderDash: [10, 5],
            borderWidth: 1,
            pointRadius: 0,
            fill: false
        });

        // æ¸²æŸ“æ‘˜è¦
        renderSummary(reportData, p, y, infRate*100);

        const ctx = document.getElementById('compChart').getContext('2d');
        if (compChart) compChart.destroy();
        compChart = new Chart(ctx, {
            type: 'line',
            data: { labels, datasets },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    tooltip: {
                        backgroundColor: 'rgba(255, 255, 255, 0.95)',
                        titleColor: '#000',
                        bodyColor: '#333',
                        borderColor: '#1a73e8',
                        borderWidth: 1,
                        padding: 12,
                        callbacks: { label: (ctx) => ` ${ctx.dataset.label}: ${ctx.raw} è¬` }
                    }
                },
                scales: {
                    y: { title: { display: true, text: 'å¯¦è³ªåƒ¹å€¼ (æ›ç®—ç‚ºä»Šæ—¥è¬å…ƒ)', font: { weight: 'bold' } } }
                }
            }
        });
    }

    function renderSummary(data, p, y, infR) {
        const reportDiv = document.getElementById('summaryReport');
        const contentDiv = document.getElementById('summaryContent');
        reportDiv.style.display = 'block';

        let html = "";
        data.forEach(item => {
            const diff = (item.final - p).toFixed(1);
            const isGrowing = item.rate > infR;
            const statusClass = isGrowing ? 'highlight-green' : 'highlight-red';
            const action = isGrowing ? "å¢å€¼äº†" : "èç¸®äº†";
            
            html += `<div class="summary-item">ğŸ“ <strong>${item.name}</strong>ï¼šåœ¨ ${y} å¹´å¾Œï¼Œæ‚¨çš„å¯¦è³ªè³¼è²·åŠ› <span class="${statusClass}">${action} ${Math.abs(diff)} è¬</span>ã€‚`;
            if(item.rate > 0) html += ` (åç›®è³‡ç”¢ç´„åœ¨ç¬¬ ${(72/item.rate).toFixed(1)} å¹´ç¿»å€)`;
            html += `</div>`;
        });
        contentDiv.innerHTML = html;
    }

    window.onload = updateComparisonChart;
</script>
</body>
</html>
