<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>72æ³•å‰‡å¯¦æ¸¬-ç†è²¡æ–¹æ¡ˆå°æ¯”</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; background: #f4f6f9; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); max-width: 1000px; margin: auto; }
        
        .input-card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .card { padding: 15px; border-radius: 10px; border: 1px solid #ddd; background: #fff; }
        .card.plan-a { border-top: 5px solid #34a853; }
        .card.plan-b { border-top: 5px solid #4285f4; }
        .card.plan-c { border-top: 5px solid #fabc05; }
        .card.inflation { border-top: 5px solid #ea4335; background: #fff5f5; }
        
        label { font-size: 0.85rem; font-weight: bold; color: #555; }
        input { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        
        button { width: 100%; padding: 15px; background: #202124; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; font-weight: bold; }
        button:hover { background: #444; }

        .chart-container { height: 500px; margin-top: 30px; position: relative; }

        /* è‡ªå‹•æ‘˜è¦å ±å‘Šå€å¡Š - é¡è‰²é‚è¼¯å°èª¿ */
        .summary-box { margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 12px; border: 1px solid #ddd; }
        .summary-box h3 { margin: 0 0 10px 0; color: #333; }
        .summary-item { margin-bottom: 8px; line-height: 1.6; color: #333; font-size: 1.05rem; }
        
        /* ä¾ç…§è¦æ±‚ï¼šå¢åŠ ç‚ºç´…è‰²ï¼Œæ¸›å°‘ç‚ºç¶ è‰² */
        .alert-increase { color: #d93025; font-weight: bold; } /* ç´…è‰² */
        .alert-decrease { color: #188038; font-weight: bold; } /* ç¶ è‰² */

        .knowledge-base { margin-top: 40px; padding: 25px; background: #f8faff; border: 1px solid #e8f0fe; border-radius: 12px; }
        .formula-box { background: #1a73e8; color: #fff; text-align: center; padding: 15px; font-size: 1.5rem; font-weight: bold; border-radius: 8px; margin: 20px 0; }
        .ref-link { padding: 8px 16px; background-color: #fff; color: #1a73e8; border: 2px solid #1a73e8; border-radius: 20px; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align:center;">72æ³•å‰‡å¯¦æ¸¬-ç†è²¡æ–¹æ¡ˆå°æ¯”</h1>
    
    <div class="input-card-grid">
        <div class="card plan-a"><h4>æ–¹æ¡ˆ A</h4><label>å¹´åˆ©ç‡ (%)</label><input type="number" id="rateA" value="1.5"></div>
        <div class="card plan-b"><h4>æ–¹æ¡ˆ B</h4><label>å¹´åˆ©ç‡ (%)</label><input type="number" id="rateB" value="6"></div>
        <div class="card plan-c"><h4>æ–¹æ¡ˆ C</h4><label>å¹´åˆ©ç‡ (%)</label><input type="number" id="rateC" value="10"></div>
        <div class="card inflation"><h4>âš ï¸å…¨å±€é€šè†¨</h4><label>å¹´é€šè†¨ (%)</label><input type="number" id="rateInf" value="3"><label>æ¨¡æ“¬å¹´æ•¸</label><input type="number" id="years" value="35"></div>
    </div>

    <div style="margin-bottom: 20px;">
        <label>åˆå§‹æœ¬é‡‘ (è¬å…ƒ)ï¼š</label>
        <input type="number" id="principal" value="100" style="width: 200px;">
    </div>

    <button onclick="updateComparisonChart()">å³æ™‚åˆ†æå¯¦è³ªè²¡å¯Œè®Šå‹•</button>

    <div id="summaryReport" class="summary-box" style="display:none;">
        <h3>ğŸ“Šæ™ºæ…§åˆ†ææ‘˜è¦</h3>
        <div id="summaryContent"></div>
    </div>

    <div class="chart-container"><canvas id="compChart"></canvas></div>

    <div class="knowledge-base">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>ğŸ“˜72 æ³•å‰‡æ·±åº¦è§£æ</h2>
            <a href="https://drive.google.com/file/d/1Lp3iPBmWRkoDQGOWY4qatXjCzYY7YlVe/view?usp=sharing" target="_blank" class="ref-link">ğŸ”— èªªæ˜æ–‡ä»¶</a>
        </div>
        <div class="formula-box">ç¿»å€å¹´æ•¸ â‰ˆ 72 Ã· å¹´åŒ–å ±é…¬ç‡ (%)</div>
    </div>
</div>

<script>
    let compChart = null;

    function updateComparisonChart() {
        const p = parseFloat(document.getElementById('principal').value);
        const y = parseInt(document.getElementById('years').value);
        const infRate = parseFloat(document.getElementById('rateInf').value) / 100;
        
        const rates = [
            { id: 'rateA', name: 'æ–¹æ¡ˆ A', color: '#34a853' },
            { id: 'rateB', name: 'æ–¹æ¡ˆ B', color: '#4285f4' },
            { id: 'rateC', name: 'æ–¹æ¡ˆ C', color: '#fabc05' }
        ];

        const labels = Array.from({length: y + 1}, (_, i) => `ç¬¬ ${i} å¹´`);
        const reportData = [];

        const datasets = rates.map(r => {
            const rVal = parseFloat(document.getElementById(r.id).value) / 100;
            const data = [];
            for(let i=0; i<=y; i++) {
                const realVal = p * Math.pow((1 + rVal) / (1 + infRate), i);
                data.push(realVal.toFixed(2));
            }
            reportData.push({ name: r.name, final: data[y], rate: rVal * 100 });

            return {
                label: `${r.name} (å¯¦è³ªåˆ©ç‡: ${(rVal*100 - infRate*100).toFixed(1)}%)`,
                data: data,
                borderColor: r.color,
                pointRadius: 0,
                pointHoverRadius: 10,
                tension: 0.3,
                fill: false
            };
        });

        // åŸºæº–ç·š
        datasets.push({
            label: 'è³¼è²·åŠ›åŸºæº–ç·š',
            data: Array(y+1).fill(p),
            borderColor: '#000',
            borderDash: [5, 5],
            borderWidth: 1,
            pointRadius: 0,
            fill: false
        });

        renderSummary(reportData, p, y);

        const ctx = document.getElementById('compChart').getContext('2d');
        if (compChart) compChart.destroy();
        compChart = new Chart(ctx, {
            type: 'line',
            data: { labels, datasets },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    tooltip: {
                        backgroundColor: 'rgba(255, 255, 255, 0.9)',
                        titleColor: '#000',
                        bodyColor: '#333',
                        borderColor: '#ddd',
                        borderWidth: 1,
                        callbacks: { label: (ctx) => ` ${ctx.dataset.label}: ${ctx.raw} è¬` }
                    }
                }
            }
        });
    }

    function renderSummary(data, p, y) {
        const reportDiv = document.getElementById('summaryReport');
        const contentDiv = document.getElementById('summaryContent');
        reportDiv.style.display = 'block';

        let html = "";
        data.forEach(item => {
            const diff = (item.final - p).toFixed(1);
            const isIncreasing = parseFloat(diff) >= 0;
            
            // é—œéµä¿®æ”¹ï¼šå¢åŠ é¡¯ç¤ºç‚ºç´…è‰² (alert-increase)ï¼Œæ¸›å°‘é¡¯ç¤ºç‚ºç¶ è‰² (alert-decrease)
            const colorClass = isIncreasing ? 'alert-increase' : 'alert-decrease';
            const statusText = isIncreasing ? 'å¯¦è³ªå¢å€¼' : 'å¯¦è³ªèç¸®';
            
            html += `<div class="summary-item">ğŸ“ <strong>${item.name}</strong>ï¼šåœ¨ ${y} å¹´å¾Œï¼Œæ‚¨çš„è³¼è²·åŠ›${statusText}äº† <span class="${colorClass}">${Math.abs(diff)} è¬</span>ã€‚`;
            if(item.rate > 0) html += ` (åç›®ç¿»å€éœ€ ${(72/item.rate).toFixed(1)} å¹´)`;
            html += `</div>`;
        });
        contentDiv.innerHTML = html;
    }

    window.onload = updateComparisonChart;
</script>
</body>
</html>
