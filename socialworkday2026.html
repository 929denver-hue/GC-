<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 社工守護計畫 - Project NEON</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        :root {
            --neon-orange: #FF3D00;
            --neon-blue: #00E5FF;
            --dark-bg: #050505;
            --panel-bg: rgba(20, 20, 20, 0.9);
            --grid-line: rgba(255, 61, 0, 0.2);
            --text-main: #E0E0E0;
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; font-family: 'Noto Sans TC', sans-serif; 
            background-color: var(--dark-bg); color: var(--text-main); 
            height: 100vh; overflow: hidden; position: relative;
        }

        /* --- 背景動態網格 & 能量核心 --- */
        .cyber-grid {
            position: absolute; width: 200%; height: 200%; top: -50%; left: -50%;
            background-image: 
                linear-gradient(var(--grid-line) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
            background-size: 40px 40px;
            transform: perspective(500px) rotateX(60deg);
            animation: gridMove 20s linear infinite; z-index: 0; opacity: 0.3;
        }
        @keyframes gridMove { from { transform: perspective(500px) rotateX(60deg) translateY(0); } to { transform: perspective(500px) rotateX(60deg) translateY(40px); } }

        /* 集氣核心：強烈的脈動感 */
        .energy-core-wrapper {
            position: absolute; top: 20%; left: 50%; transform: translateX(-50%);
            width: 300px; height: 300px; display: flex; justify-content: center; align-items: center; z-index: 0;
        }
        .energy-core {
            width: 150px; height: 150px; background: radial-gradient(circle, var(--neon-orange), transparent);
            border-radius: 50%; filter: blur(20px); opacity: 0.6;
            animation: pulseCore 3s infinite ease-in-out;
        }
        .core-ring {
            position: absolute; width: 200px; height: 200px; border: 1px solid var(--neon-orange); border-radius: 50%;
            animation: spinRing 10s linear infinite; opacity: 0.5; border-left-color: transparent; border-right-color: transparent;
        }
        @keyframes pulseCore { 0%,100% { transform: scale(1); opacity:0.6; } 50% { transform: scale(1.5); opacity:0.9; } }
        @keyframes spinRing { 100% { transform: rotate(360deg); } }

        /* --- UI 框架 --- */
        .hud-container {
            position: relative; z-index: 10; height: 100%; display: flex; flex-direction: column;
            padding: 20px; max-width: 480px; margin: 0 auto;
            background: radial-gradient(circle at center, transparent 0%, #000 120%);
        }

        /* 頂部數據列 */
        .top-status {
            display: flex; justify-content: space-between; align-items: flex-end;
            border-bottom: 2px solid var(--neon-blue); padding-bottom: 10px; margin-bottom: 20px;
        }
        .status-block { font-family: 'Orbitron', sans-serif; font-size: 10px; color: var(--neon-blue); letter-spacing: 1px; }
        .big-num { font-size: 18px; font-weight: bold; color: #fff; text-shadow: 0 0 10px var(--neon-blue); }

        /* 跑馬燈：科技風 */
        .cyber-marquee {
            font-family: 'Orbitron', monospace; font-size: 10px; color: var(--neon-orange);
            background: rgba(0,0,0,0.5); padding: 5px; border: 1px solid var(--neon-orange);
            margin-bottom: 20px; overflow: hidden; white-space: nowrap; text-transform: uppercase;
        }

        /* --- 主終端機 (Terminal) --- */
        .terminal-window {
            flex: 1; background: var(--panel-bg); border: 1px solid #333;
            border-radius: 4px; position: relative; overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.5); display: flex; flex-direction: column;
        }
        .terminal-window::before { /* 掃描線效果 */
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%);
            background-size: 100% 4px; z-index: 100; pointer-events: none;
        }
        .terminal-window::after { /* 四角裝飾 */
            content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
            border: 2px solid transparent;
            background: linear-gradient(to right, var(--neon-orange) 2px, transparent 2px) 0 0,
                        linear-gradient(to bottom, var(--neon-orange) 2px, transparent 2px) 0 0,
                        linear-gradient(to left, var(--neon-orange) 2px, transparent 2px) 100% 0,
                        linear-gradient(to bottom, var(--neon-orange) 2px, transparent 2px) 100% 0,
                        linear-gradient(to right, var(--neon-orange) 2px, transparent 2px) 0 100%,
                        linear-gradient(to top, var(--neon-orange) 2px, transparent 2px) 0 100%,
                        linear-gradient(to left, var(--neon-orange) 2px, transparent 2px) 100% 100%,
                        linear-gradient(to top, var(--neon-orange) 2px, transparent 2px) 100% 100%;
            background-repeat: no-repeat; background-size: 20px 20px; z-index: 101; pointer-events: none;
        }

        /* 內容切換區 */
        .view-port { flex: 1; position: relative; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; }

        /* --- STATE 1: IDLE (等待連結) --- */
        .idle-screen {
            height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;
        }
        .scan-circle {
            width: 120px; height: 120px; border: 2px dashed var(--neon-orange); border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            animation: rotateScan 10s linear infinite; margin-bottom: 30px; cursor: pointer;
            box-shadow: 0 0 15px var(--neon-orange); transition: 0.3s; position: relative;
        }
        .scan-circle:hover { box-shadow: 0 0 30px var(--neon-orange); transform: scale(1.05); }
        .scan-text { font-family: 'Orbitron'; color: #fff; font-size: 12px; animation: none; transform: rotate(0); position: absolute; }
        
        @keyframes rotateScan { 100% { transform: rotate(360deg); } }

        /* --- STATE 2: LINKED (連結建立) --- */
        .data-stream { display: none; flex-direction: column; height: 100%; opacity: 0; animation: fadeIn 0.5s forwards; }
        @keyframes fadeIn { to { opacity: 1; } }

        .target-visual {
            width: 100%; height: 200px; position: relative; margin-bottom: 15px; border: 1px solid #333; overflow: hidden;
        }
        .target-img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(100%) contrast(1.2) brightness(0.8); }
        .overlay-data {
            position: absolute; bottom: 0; left: 0; width: 100%; background: linear-gradient(transparent, #000);
            padding: 10px; color: var(--neon-blue); font-family: 'Orbitron'; font-size: 12px;
        }

        /* 對話式互動 (取代表格) */
        .console-log { font-family: 'Noto Sans TC'; font-size: 13px; line-height: 1.6; color: #ccc; margin-bottom: 15px; }
        .typing-effect::after { content: '▋'; animation: blinkCursor 0.8s infinite; color: var(--neon-orange); }
        @keyframes blinkCursor { 50% { opacity: 0; } }

        /* 選項按鈕 (科技感) */
        .option-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .tech-btn {
            background: rgba(255, 255, 255, 0.05); border: 1px solid #444; color: #aaa;
            padding: 10px; font-size: 12px; cursor: pointer; text-align: left; transition: 0.2s;
            position: relative; overflow: hidden;
        }
        .tech-btn:hover, .tech-btn.active {
            border-color: var(--neon-orange); color: #fff; background: rgba(255, 61, 0, 0.1);
            box-shadow: 0 0 10px rgba(255, 61, 0, 0.2);
        }
        .tech-btn.active::before { content: '>'; position: absolute; right: 10px; color: var(--neon-orange); }

        /* 贊助商植入 (Reasoning) */
        .sponsor-logic-box {
            border-left: 2px solid var(--neon-blue); background: linear-gradient(90deg, rgba(0,229,255,0.1), transparent);
            padding: 10px; margin-bottom: 15px; font-size: 12px; color: #fff;
        }
        .sponsor-reason { color: var(--neon-blue); font-weight: bold; font-size: 10px; margin-bottom: 4px; display: block; }

        /* 底部操作列 */
        .action-panel {
            margin-top: auto; border-top: 1px solid #333; padding-top: 15px; display: flex; gap: 10px;
        }
        .input-field {
            flex: 1; background: #111; border: 1px solid #444; color: #fff; padding: 10px;
            font-family: 'Noto Sans TC'; font-size: 14px; outline: none;
        }
        .send-btn {
            background: var(--neon-orange); color: #000; border: none; padding: 0 20px;
            font-family: 'Orbitron'; font-weight: bold; cursor: pointer; clip-path: polygon(10% 0, 100% 0, 100% 90%, 90% 100%, 0 100%, 0 10%);
        }
        .send-btn:hover { background: #fff; box-shadow: 0 0 15px var(--neon-orange); }

        /* --- 預覽卡片 (全息投影感) --- */
        #preview-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 200; align-items: center; justify-content: center;
        }
        #capture-target {
            width: 320px; height: 500px; background: #000; position: relative; overflow: hidden;
            border: 1px solid #333; box-shadow: 0 0 30px rgba(0, 229, 255, 0.2);
        }
        /* 壓在照片上的署名 (核心需求) */
        .watermark-signature {
            position: absolute; bottom: 80px; right: 20px; z-index: 20;
            font-family: 'Orbitron'; font-weight: bold; font-size: 18px; color: rgba(255,255,255,0.8);
            transform: rotate(-5deg); text-shadow: 0 0 5px var(--neon-orange);
            border: 2px solid rgba(255,255,255,0.5); padding: 5px 15px; border-radius: 4px;
            letter-spacing: 2px; mix-blend-mode: overlay;
        }
        .card-final-img { width: 100%; height: 100%; object-fit: cover; filter: grayscale(50%) contrast(1.1); }
        .card-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: linear-gradient(to bottom, transparent 60%, #000 100%);
            display: flex; flex-direction: column; justify-content: flex-end; padding: 20px;
        }
        .card-msg { color: #fff; font-size: 14px; margin-bottom: 50px; text-shadow: 0 1px 3px #000; font-weight: 500; }
        .card-sponsor-tag {
            position: absolute; top: 20px; right: 20px; background: var(--neon-blue); color: #000;
            font-size: 10px; font-weight: bold; padding: 2px 8px; clip-path: polygon(10% 0, 100% 0, 100% 100%, 0 100%, 0 10%);
        }

        /* 隱藏元素 */
        .hidden { display: none; }
        
        /* 贊助商列表 (Footer) */
        .sponsor-footer {
            margin-top: 10px; text-align: center; opacity: 0.5; font-size: 10px; color: #666;
        }

    </style>
</head>
<body>

    <div class="cyber-grid"></div>
    <div class="energy-core-wrapper">
        <div class="core-ring"></div>
        <div class="energy-core"></div>
    </div>

    <div class="hud-container">
        
        <div class="top-status">
            <div class="status-block">
                <div>GLOBAL ENERGY</div>
                <div class="big-num">LV.78</div>
            </div>
            <div class="status-block" style="text-align:right;">
                <div>DAILY LIMIT</div>
                <div class="big-num"><span id="daily-cnt">3</span>/3</div>
            </div>
        </div>

        <div class="cyber-marquee">
            <span id="marquee-text">SYSTEM READY... WAITING FOR INPUT... // USER888 CONNECTED TO HUALIEN // TSMC SQUAD JOINED // </span>
        </div>

        <div class="terminal-window">
            
            <div class="view-port">
                
                <div id="view-idle" class="idle-screen">
                    <div class="scan-circle" onclick="startLink()">
                        <div class="scan-text">TOUCH TO<br>LINK</div>
                    </div>
                    <div style="font-size:12px; color:#666; letter-spacing:1px;">ESTABLISH CONNECTION WITH SOCIAL WORKER</div>
                </div>

                <div id="view-stream" class="data-stream">
                    <div class="target-visual">
                        <img id="target-img" class="target-img" src="">
                        <div class="overlay-data">
                            TARGET: <span id="target-name">UNKNOWN</span><br>
                            STATUS: ONLINE
                        </div>
                    </div>

                    <div class="console-log" id="story-log">
                        <span style="color:var(--neon-blue)">> SYSTEM:</span> 連線成功。<br>
                        <span style="color:var(--neon-blue)">> DOWNLOAD:</span> 讀取單位檔案...<br><br>
                        <span id="story-content" class="typing-effect"></span>
                    </div>

                    <div id="interaction-layer" class="hidden">
                        
                        <div class="sponsor-logic-box">
                            <span class="sponsor-reason">⚠ DETECTED: 該單位長期戶外訪視</span>
                            <span style="font-size:14px;">建議配置 <strong>[蓓朵娜防曬]</strong> 以防禦紫外線傷害？</span>
                            <div class="option-grid" style="margin-top:10px;">
                                <div class="tech-btn" onclick="confirmSponsor(this, '蓓朵娜防曬', '抵抗烈日')">
                                    [確認配給]<br><span style="font-size:10px;color:#666;">由 蓓朵娜 提供</span>
                                </div>
                                <div class="tech-btn" onclick="confirmSponsor(this, '鼎王湯底', '補充熱量')">
                                    [更換裝備]<br><span style="font-size:10px;color:#666;">改送 鼎王湯底</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="console-log">
                            <span style="color:var(--neon-blue)">> ANALYSIS:</span> 請選擇精神同步頻率：
                        </div>
                        <div class="option-grid" id="tag-options">
                            </div>

                    </div>
                </div>

            </div>

            <div class="action-panel">
                <input type="text" id="user-sign" class="input-field" placeholder="輸入代號 (署名)" style="flex:0.4; border-right:none;">
                <input type="text" id="user-msg" class="input-field" placeholder="輸入傳輸訊息...">
                <button class="send-btn" onclick="processTransmission()">SEND</button>
            </div>

        </div>

        <div class="sponsor-footer">
            POWERED BY: 鼎王 / 艾瑪絲 / 蓓朵娜<br>
            <span style="color:var(--neon-blue); cursor:pointer;" onclick="alert('背包功能')">[OPEN INVENTORY]</span>
        </div>

    </div>

    <div id="preview-modal">
        <div style="display:flex; flex-direction:column; align-items:center;">
            
            <div id="capture-target">
                <img id="card-img" class="card-final-img" src="">
                <div class="card-overlay">
                    <div id="card-sponsor" class="card-sponsor-tag"></div>
                    <div id="card-msg" class="card-msg"></div>
                </div>
                <div id="card-sign" class="watermark-signature"></div>
            </div>

            <div style="margin-top:20px; width:320px; display:flex; gap:10px;">
                <button class="send-btn" style="flex:1; background:#fff; color:#000;" onclick="closeModal()">RE-SYNC</button>
                <button class="send-btn" style="flex:1;" onclick="finalUpload()">CONFIRM</button>
            </div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const units = [
            {
                name: "屏東伯大尼之家",
                img: "https://images.unsplash.com/photo-1544027993-37dbfe43562a?auto=format&fit=crop&w=800&q=80",
                desc: "在國境之南，我們陪伴140多位憨兒慢飛。從農場勞動到生活自理，每一步都走得不容易。",
                need: "戶外勞動",
                sponsor: { name: "艾瑪絲洗髮", reason: "洗去汗水與疲憊" },
                tags: ["#堅韌防線", "#慢飛守護者"]
            },
            {
                name: "華山基金會",
                img: "https://images.unsplash.com/photo-1516307365426-bea591f05011?auto=format&fit=crop&w=800&q=80",
                desc: "穿梭偏鄉小巷，那件背心是獨居長輩唯一的盼望。我們遞送的不只是便當，更是家的感覺。",
                need: "深夜加班",
                sponsor: { name: "鼎王湯底", reason: "溫暖身心" },
                tags: ["#溫柔信號", "#獨老依靠"]
            }
        ];

        let currentUnit = null;
        let selectedSponsor = null;
        let selectedTag = null;
        let dailyLimit = 3;

        // --- LOGIC ---
        function startLink() {
            if(dailyLimit <= 0) return alert("ENERGY DEPLETED. TRY TOMORROW.");

            // UI Transition
            document.getElementById('view-idle').classList.add('hidden');
            document.getElementById('view-stream').style.display = 'flex';
            
            // Random Unit
            currentUnit = units[Math.floor(Math.random() * units.length)];
            
            // Render Data
            document.getElementById('target-img').src = currentUnit.img;
            document.getElementById('target-name').innerText = currentUnit.name;
            
            // Typewriter Effect
            const text = currentUnit.desc;
            const el = document.getElementById('story-content');
            let i = 0;
            el.innerHTML = "";
            
            function typeWriter() {
                if (i < text.length) {
                    el.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(typeWriter, 30); // Typing speed
                } else {
                    el.classList.remove('typing-effect');
                    document.getElementById('interaction-layer').classList.remove('hidden');
                    renderOptions();
                }
            }
            typeWriter();
        }

        function renderOptions() {
            // Render Sponsor Suggestion based on Unit context
            const logicBox = document.querySelector('.sponsor-logic-box');
            logicBox.querySelector('.sponsor-reason').innerText = `⚠ ANALYSIS: ${currentUnit.need} 检测`;
            logicBox.querySelector('span:nth-child(2)').innerHTML = `建議配置 <strong>[${currentUnit.sponsor.name}]</strong> 以${currentUnit.sponsor.reason}？`;
            
            // Render Tags
            const tagBox = document.getElementById('tag-options');
            tagBox.innerHTML = '';
            currentUnit.tags.forEach(tag => {
                const btn = document.createElement('div');
                btn.className = 'tech-btn';
                btn.innerText = tag;
                btn.onclick = () => {
                    document.querySelectorAll('.tech-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedTag = tag;
                };
                tagBox.appendChild(btn);
            });
            
            // Set default sponsor selection
            selectedSponsor = currentUnit.sponsor.name;
        }

        function confirmSponsor(el, name, reason) {
            // Visual toggle logic
            document.querySelectorAll('.sponsor-logic-box .tech-btn').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            selectedSponsor = name;
        }

        function processTransmission() {
            const sign = document.getElementById('user-sign').value || "UNKNOWN";
            const msg = document.getElementById('user-msg').value;

            if(!selectedTag) return alert("ERROR: 頻率未同步 (請選擇標籤)");
            if(!msg) return alert("ERROR: 訊息為空");

            // Render Preview
            document.getElementById('card-img').src = currentUnit.img;
            document.getElementById('card-sponsor').innerText = `SUPPLY: ${selectedSponsor}`;
            document.getElementById('card-msg').innerText = `"${msg}"`;
            
            // 關鍵修改：署名壓在照片上
            document.getElementById('card-sign').innerText = sign.toUpperCase(); // Tech style is usually uppercase
            
            document.getElementById('preview-modal').style.display = 'flex';
        }

        function finalUpload() {
            dailyLimit--;
            document.getElementById('daily-cnt').innerText = dailyLimit;
            alert("TRANSMISSION COMPLETE. // 傳輸成功");
            closeModal();
            // Reset view
            document.getElementById('view-idle').classList.remove('hidden');
            document.getElementById('view-stream').style.display = 'none';
            document.getElementById('interaction-layer').classList.add('hidden');
        }

        function closeModal() {
            document.getElementById('preview-modal').style.display = 'none';
        }
    </script>
</body>
</html>
