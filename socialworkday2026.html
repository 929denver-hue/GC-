<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬ä¸ƒå±† çµ¦ç¤¾å·¥æ„›çš„é¼“å‹µ - åƒç´ å®ˆè­·è€… (V2)</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --gc-orange: #FF8C00;
            --gc-yellow: #FFD700;
            --pixel-bg: #2C2C2C;
            --text-color: #333;
            --white: #fff;
            --heart-red: #FF4444;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Press Start 2P', cursive;
            background-color: var(--pixel-bg);
            color: var(--white);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* --- Boss è¡€æ¢ --- */
        .boss-bar-container {
            width: 100%;
            max-width: 500px;
            margin-bottom: 20px;
        }
        .health-bar-frame {
            border: 4px solid var(--white);
            height: 25px;
            background: #000;
            padding: 2px;
        }
        .health-bar-fill {
            height: 100%;
            background: #FF4444;
            width: 40%;
            transition: width 0.5s;
        }

        /* --- éŠæˆ²ä¸»æ©Ÿ --- */
        .game-console {
            background-color: var(--gc-orange);
            padding: 20px;
            border: 4px solid #000;
            box-shadow: 8px 8px 0px rgba(0,0,0,0.5);
            width: 100%;
            max-width: 400px; /* æ‰‹æ©Ÿå‹å–„å¯¬åº¦ */
            border-radius: 4px;
            position: relative;
        }

        /* è¢å¹• */
        .screen {
            background-color: #fff;
            border: 4px solid #333;
            height: 320px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px;
            color: var(--text-color);
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        /* --- æŠ•å¹£å£å€åŸŸ (æ–°å¢) --- */
        .coin-slot-area {
            display: flex;
            justify-content: flex-end; /* é å³æ”¾ */
            margin-bottom: 10px;
            position: relative;
            height: 50px;
        }

        .coin-slot {
            width: 15px;
            height: 40px;
            background: #000;
            border: 2px solid #555;
            border-radius: 2px;
            box-shadow: inset 0 0 5px #222;
            position: relative;
        }
        
        .coin-slot::after {
            content: "INSERT";
            position: absolute;
            top: 45px;
            left: -15px;
            font-size: 8px;
            color: #000;
            width: 50px;
            text-align: center;
        }

        /* æ„›å¿ƒä»£å¹£ (æŒ‰éˆ•) */
        .heart-token {
            font-size: 30px;
            color: var(--heart-red);
            cursor: pointer;
            position: absolute;
            right: 40px; /* åˆå§‹ä½ç½® */
            top: 5px;
            text-shadow: 2px 2px 0 #000;
            animation: bounce 1s infinite;
            z-index: 10;
        }

        .heart-token:hover {
            transform: scale(1.1);
        }

        /* æ„›å¿ƒæŠ•å…¥å‹•ç•« Class */
        .inserting-anim {
            animation: insertMove 1s forwards !important; /* è¦†è“‹ bounce */
        }

        @keyframes insertMove {
            0% { right: 40px; top: 5px; opacity: 1; transform: scale(1); }
            50% { right: 0px; top: 5px; opacity: 1; transform: scale(0.5); }
            100% { right: 0px; top: 5px; opacity: 0; transform: scale(0.1); }
        }

        /* æŠ•å¹£æç¤ºæ–‡å­— */
        .insert-hint {
            position: absolute;
            right: 80px;
            top: 15px;
            font-size: 10px;
            color: #000;
            animation: blink 1s infinite;
        }

        /* --- ç‹€æ…‹é¡¯ç¤º --- */
        .state-idle { text-align: center; }
        .state-spinning { display: none; font-size: 20px; }
        
        /* çœŸå¯¦æ•…äº‹é¡¯ç¤ºå€ */
        .state-quest { 
            display: none; width: 100%; text-align: left; 
        }
        .real-photo-frame {
            width: 100%; height: 160px;
            background: #000;
            margin-bottom: 10px;
            overflow: hidden;
            border: 2px solid #000;
        }
        .real-photo { width: 100%; height: 100%; object-fit: cover; }
        .quest-tag { 
            background: var(--gc-orange); color: #fff; 
            padding: 2px 6px; font-size: 10px; display: inline-block; 
        }

        /* --- æŒ‰éˆ•æ§åˆ¶å€ --- */
        .controls { text-align: center; }

        .btn-main {
            background-color: #888; /* é è¨­ç°è‰²(æœªè§£é–) */
            color: #ccc;
            border: 4px solid #555;
            padding: 15px 0;
            width: 100%;
            font-family: 'Press Start 2P';
            font-size: 12px;
            cursor: not-allowed;
            pointer-events: none; /* ç¦æ­¢é»æ“Š */
            box-shadow: none;
            transition: all 0.3s;
        }

        /* è§£é–ç‹€æ…‹ */
        .btn-unlocked {
            background-color: #FF4444;
            color: #fff;
            border-color: #8B0000;
            cursor: pointer;
            pointer-events: auto;
            box-shadow: 0 4px 0 #8B0000;
            animation: pulse 1s infinite; /* è§£é–å¾Œå‘¼å¸ç‡ˆæ•ˆæœ */
        }
        
        .btn-unlocked:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* ç•™è¨€å€ */
        .message-area { display: none; margin-top: 15px; }
        textarea {
            width: 100%; height: 60px;
            border: 2px solid #000; padding: 5px;
            font-family: sans-serif; font-size: 14px;
        }

        /* --- å‹•ç•«é—œéµå½±æ ¼ --- */
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        @keyframes blink { 50% { opacity: 0; } }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

    </style>
</head>
<body>

    <div class="boss-bar-container">
        <div style="font-size: 10px; margin-bottom:5px; text-align:center;">
            å…¨æœç´¯ç©é¼“å‹µå€¼ (Lv.7)
        </div>
        <div class="health-bar-frame">
            <div class="health-bar-fill" id="boss-hp"></div>
        </div>
    </div>

    <div class="game-console">
        
        <div class="screen">
            <div id="state-idle" class="state-idle">
                <div style="font-size: 40px; margin-bottom: 20px;">ğŸ›¡ï¸</div>
                <div style="line-height: 1.5;">
                    PIXEL HERO<br>
                    <span style="font-size: 10px; color: #888;">è«‹æŠ•å…¥æ„›å¿ƒå•Ÿå‹•</span>
                </div>
            </div>

            <div id="state-spinning" class="state-spinning">
                <div>CONNECTING...</div>
                <div id="spin-icon" style="font-size: 40px; margin-top: 20px;">â¤ï¸</div>
            </div>

            <div id="state-quest" class="state-quest">
                <div class="real-photo-frame">
                    <img id="quest-img" class="real-photo" src="">
                </div>
                <div class="quest-tag" id="quest-tag">TAG</div>
                <div style="font-size: 12px; margin: 5px 0; font-weight: bold;" id="quest-name">NAME</div>
                <div style="font-size: 10px; line-height: 1.4; color: #555;" id="quest-story">STORY</div>
            </div>
        </div>

        <div class="coin-slot-area">
            <div id="insert-hint" class="insert-hint">é»æ“ŠæŠ•å…¥æ„›å¿ƒ â–¶</div>
            <div id="heart-token" class="heart-token">â¤ï¸</div>
            <div class="coin-slot"></div>
        </div>

        <div class="controls">
            <button id="btn-spin" class="btn-main">è«‹å…ˆæŠ•å¹£ (INSERT LOVE)</button>

            <div id="message-area" class="message-area">
                <textarea id="msg-input" placeholder="å¯«ä¸‹æ‚¨çš„é¼“å‹µ..."></textarea>
                <button id="btn-send" class="btn-main btn-unlocked" style="margin-top:10px; background:#FF8C00;">ç™¼é€æº«æš–</button>
            </div>
        </div>

    </div>

    <div style="margin-top: 20px; font-size: 10px; color: #aaa;">
        æˆ‘çš„æŠ½çåˆ¸: <span id="ticket-count" style="color:#fff; font-size:14px;">0</span> å¼µ
    </div>

    <script>
        // è³‡æ–™åº«
        const units = [
            {
                name: "å±æ±ä¼¯å¤§å°¼ä¹‹å®¶",
                tag: "#æ·±å¤œçš„ç‡ˆå¡”",
                story: "ã€Œå­©å­åŠå¤œå“­é†’æ™‚ï¼Œç¬¬ä¸€å€‹æŠ±ä½ä»–å€‘çš„ï¼Œé€šå¸¸ä¸æ˜¯çˆ¸åª½ï¼Œè€Œæ˜¯å€¼ç­çš„æˆ‘å€‘ã€‚ã€",
                img: "https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?auto=format&fit=crop&w=600&q=80"
            },
            {
                name: "è¯å±±åŸºé‡‘æœƒ",
                tag: "#æ™‚é–“çš„é™ªä¼´è€…",
                story: "ã€Œæœ‰æ™‚å€™ï¼Œé˜¿å…¬é˜¿å¬¤ç­‰çš„ä¸æ˜¯é‚£å€‹ä¾¿ç•¶ï¼Œè€Œæ˜¯é€ä¾¿ç•¶çš„é‚£å€‹äººï¼Œèƒ½è·Ÿä»–èªªèªªè©±ã€‚ã€",
                img: "https://images.unsplash.com/photo-1516307365426-bea591f05011?auto=format&fit=crop&w=600&q=80"
            }
        ];

        // å…ƒç´ 
        const heartToken = document.getElementById('heart-token');
        const insertHint = document.getElementById('insert-hint');
        const btnSpin = document.getElementById('btn-spin');
        const stateIdle = document.getElementById('state-idle');
        const stateSpinning = document.getElementById('state-spinning');
        const stateQuest = document.getElementById('state-quest');
        const msgArea = document.getElementById('message-area');
        const btnSend = document.getElementById('btn-send');
        const ticketCount = document.getElementById('ticket-count');

        let isCoinInserted = false;
        let tickets = 0;

        // 1. æŠ•å…¥æ„›å¿ƒ (å„€å¼æ„Ÿé—œéµ)
        heartToken.addEventListener('click', () => {
            if(isCoinInserted) return; // é¿å…é‡è¤‡é»æ“Š

            // æ’­æ”¾å‹•ç•«ï¼šæ„›å¿ƒé£›é€²å»
            heartToken.classList.add('inserting-anim');
            insertHint.style.display = 'none';

            // æ¨¡æ“¬æŠ•å¹£éŸ³æ•ˆå»¶é²
            setTimeout(() => {
                isCoinInserted = true;
                
                // è§£é–æ‹‰æ¡¿æŒ‰éˆ•
                btnSpin.innerText = "è½‰å‹•ç·£åˆ† (START)";
                btnSpin.classList.remove('btn-main'); // ç§»é™¤ç°è‰²æ¨£å¼
                btnSpin.classList.add('btn-main', 'btn-unlocked'); // åŠ å…¥ç´…è‰²æ¨£å¼
                
                // è¢å¹•æ–‡å­—è®ŠåŒ–
                stateIdle.innerHTML = '<div style="font-size:30px; margin-bottom:10px;">READY!</div><div style="font-size:10px;">ç·£åˆ†å·²é€£ç·š</div>';
                
            }, 800); // é…åˆ CSS å‹•ç•«æ™‚é–“
        });

        // 2. è½‰å‹•æ‹‰éœ¸
        btnSpin.addEventListener('click', () => {
            if(!isCoinInserted) return;

            // åˆ‡æ›ç•«é¢
            stateIdle.style.display = 'none';
            stateSpinning.style.display = 'block';
            btnSpin.style.display = 'none'; // éš±è—æŒ‰éˆ•ï¼Œé€²å…¥ä»»å‹™æ¨¡å¼

            // è½‰å‹•å‹•ç•«
            let icons = ['â¤ï¸', 'ğŸ›¡ï¸', 'ğŸ', 'âš¡'];
            let spinInterval = setInterval(() => {
                document.getElementById('spin-icon').innerText = icons[Math.floor(Math.random()*icons.length)];
            }, 100);

            // åœæ­¢ä¸¦é¡¯ç¤ºçµæœ
            setTimeout(() => {
                clearInterval(spinInterval);
                showQuest();
            }, 1500);
        });

        // 3. é¡¯ç¤ºçœŸå¯¦æ•…äº‹
        function showQuest() {
            const unit = units[Math.floor(Math.random() * units.length)];
            
            document.getElementById('quest-img').src = unit.img;
            document.getElementById('quest-tag').innerText = unit.tag;
            document.getElementById('quest-name').innerText = unit.name;
            document.getElementById('quest-story').innerText = unit.story;

            stateSpinning.style.display = 'none';
            stateQuest.style.display = 'block';
            msgArea.style.display = 'block'; // é¡¯ç¤ºç•™è¨€æ¡†
        }

        // 4. é€å‡ºé¼“å‹µ (Reset æ©Ÿåˆ¶)
        btnSend.addEventListener('click', () => {
            const input = document.getElementById('msg-input');
            if(input.value.trim() === "") {
                alert("è«‹å¯«ä¸‹ä¸€å¥é¼“å‹µçš„è©±å–”ï¼");
                return;
            }

            // æ›´æ–°æ•¸æ“š
            tickets++;
            ticketCount.innerText = tickets;
            input.value = "";

            alert("æº«æš–å·²é€é”ï¼ç²å¾—æŠ½çåˆ¸ x1");

            // é‡ç½®éŠæˆ²ç‹€æ…‹ (è®“ä½¿ç”¨è€…å¯ä»¥å†ç©ä¸€æ¬¡)
            resetGame();
        });

        function resetGame() {
            // å›å¾©è®Šæ•¸
            isCoinInserted = false;

            // å›å¾©æ„›å¿ƒä½ç½®
            heartToken.classList.remove('inserting-anim');
            insertHint.style.display = 'block';

            // å›å¾©è¢å¹•
            stateQuest.style.display = 'none';
            msgArea.style.display = 'none';
            stateIdle.style.display = 'block';
            stateIdle.innerHTML = '<div style="font-size: 40px; margin-bottom: 20px;">ğŸ›¡ï¸</div><div style="line-height: 1.5;">PIXEL HERO<br><span style="font-size: 10px; color: #888;">è«‹æŠ•å…¥æ„›å¿ƒå•Ÿå‹•</span></div>';

            // é–å®šæŒ‰éˆ•
            btnSpin.style.display = 'block';
            btnSpin.innerText = "è«‹å…ˆæŠ•å¹£ (INSERT LOVE)";
            btnSpin.classList.remove('btn-unlocked');
        }

    </script>
</body>
</html>
